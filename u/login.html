<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<base href=".." />
<meta name="author" content="">
<link href="css/bootstrap.css" rel="stylesheet" media="screen">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/style.css" rel="stylesheet">
<title>Login | Prospect.us</title>
<script>
  function doLogin() {
    var u = document.querySelector("#login-form input[name=username]").value;
    var p = document.querySelector("#login-form input[name=password]").value;
    ProspectBrijj.login(u, p, didLogin);
  }

  function didLogin(x) {
    if (x) {
      document.location.href = 'home.html';
      return;
    }
    var errdiv = document.querySelector('#login-error-div');
    errdiv.innerHTML = 'Invalid email/password combination';
  }

  function forgotForm() {
  /* This hack is a workaround for the Chrome handling of required attributes */
	var qs = document.querySelectorAll("#login-form input[required]");
	for(var i=0;i < qs.length;i++) { qs[i].removeAttribute("required"); qs[i].setAttribute("requiredx"); }
  	document.querySelector('#login-form').style.display='none';
  	document.querySelector('#forgot-form').style.display='block';
  }
  function doForgot() {
    var u = document.querySelector("#forgot-form input[name=username]").value;
    ProspectBrijj.forgot(u, [didForget, forgetError] );
  }

  function forgetError(x) {
	var fed = document.querySelector("#forgot-error-div");
	fed.innerHTML = x.message;
  }
  function didForget(x) {
  	var fed = document.querySelector("#forgot-error-div");
	if (x) {
		fed.innerHTML = "Email to reset password has been sent";
		document.querySelector("#forgot-form button[type=submit]").disabled=true;
    }
	else fed.innerHTML = "Failed to send email to reset password";
  }
</script>
</head>
<body>
  <div class="container">
    <div class="row-fluid">
      <section id="topbar">
        <div class="span12" id="homenav">
          <a href="index.html"><img src="img/logo2.png" id="homelogo" alt="Prospect.us logo"></a>
          <div class="btn-toolbar pull-right">
            <button class="btn btn-home" type="button" onclick="location.href='login.html'">Login</button>
            <button class="btn btn-home btn-success" type="button" onclick="location.href='signup.html'">Sign Up</button>
          </div>
        </div>
      </section>
    </div>
    <div class="row-fluid">
      <section id="corenav">
        <div class="span12 navbar">
          <div>
            <ul class="nav">
              <li><a href="#">FOR COMPANIES</a></li>
              <li><a href="#">FOR FUNDERS</a></li>
              <li><a href="#">ABOUT US</a></li>
            </ul>
          </div>
        </div>
      </section>
    </div>
    <div class="row-fluid">
      <section>
        <div id="login-form" class="span12 pagination-centered">
          <br>
          <h1>Welcome Back</h1>
          <div id="login-error-div" class="text-error"></div>
          <form id="login" class="center" action="" method="post" onsubmit="doLogin(); return false;">
            <fieldset>
              <label class="loginLabel">Email:</label> <input required class="loginInput" placeholder="email" tabindex="1"
                autocapitalize="off" name="username" type="email"> <label class="loginLabel">Password:</label> <input
                required class="loginInput" id="login_password" placeholder="password" tabindex="2" name="password" type="password">
              <button id="forgotButton" class="btn" onClick="forgotForm()">Forgot Your Password?</button>
              <button id="loginButton" type="submit" class="btn btn-success" tabindex="3">Sign in</button>
              <br>
            </fieldset>
          </form>
        </div>
        <div id="forgot-form" style="display: none" class="span12 pagination-centered">
          <br>
          <h1>Forgot your password?</h1>
          <div id="forgot-error-div" class="text-error"></div>
          <form id="login" class="center" action="" method="post" onsubmit="doForgot(); return false;">
            <fieldset>
              <label class="loginLabel">Email:</label> <input required class="loginInput" placeholder="email" tabindex="1"
                autocapitalize="off" name="username" type="email"> <br>
              <button id="loginButton" type="submit" class="btn btn-success" tabindex="3">Reset my password</button>
              <br>
            </fieldset>
          </form>
        </div>
      </section>
    </div>
  </div>
  <script src="script/jquery.js"></script>
  <script src="script/bootstrap.js"></script>
  <script src="brijj/brijj.js"></script>
</body>
</html>
