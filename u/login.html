<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<base href=".." />
<meta name="author" content="">
<link href="css/bootstrap.css" rel="stylesheet" media="screen">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/style.css" rel="stylesheet">
<title>Login |ShareWave</title>
<style>
.hreffy {
  cursor: pointer;
  text-decoration: underline;
  color: #9922AA;
/*  outline: thin dotted #333;
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
  */
}

.boilerplate {
  height: 480px;
  overflow: auto;
}
</style>
<script>

  function getParams() {
  var params = document.location.search.substring(1).split('&');
  for (var i = 0; i < params.length; i++) {
    var param = params[i].split('=');
    params[unescape(param[0])] = unescape(param[1]);
  }
  return params;
}

  function retrievedRegister(x) {
		document.getElementsByName('firstname')[0].value = x[1][0];
		document.getElementsByName('lastname')[0].value = x[1][1];
		document.getElementsByName('investoremail')[0].value = x[1][2];
  }

  function doLogin() {
	var u = document.querySelector("#login-form input[name=username]").value;
    var p = document.querySelector("#login-form input[name=password]").value;
    SWBrijj.login(u, p, didLogin);
  }

  function didLogin(x) {
    if (x) {
      document.location.href = '../v/profile.html';
      return;
    }
    var errdiv = document.querySelector('#login-error-div');
    errdiv.innerHTML = 'Invalid email/password combination';
  }
  
  function doRegister() {
    var u = document.querySelector("#signup-form input[name=investoremail]").value;
	var f = document.querySelector("#signup-form input[name=firstname]").value;
	var l = document.querySelector("#signup-form input[name=lastname]").value;
	var x = 0
	var y = 0
	if (document.querySelector("#signup-form input[name=TOSBox]").checked) {
		x = 1;
	}
	if (document.querySelector("#signup-form input[name=electBox]").checked) {
		y = 1;
	}
	var p = document.querySelector("#signup-form input[name=password]").value;
	if (x != 1 || y != 1) {
		var errdiv = document.querySelector('#register-error-div');
     	errdiv.innerHTML = 'Must agree to TOS and Digital Communications';
	}
	else {
		var m = getParams();
		var code = m['code']
		SWBrijj.activate(u, code, p, f, l, x, [didRegister, didntRegister]);
	}
  }

  function didRegister(x) {
      loginForm()
	  var greeting = document.querySelector("#Greeting");
	  greeting.innerHTML = "Welcome!";
	  var errdiv = document.querySelector('#login-error-div');
      errdiv.innerHTML = 'Welcome to ShareWave! Please login to confirm your registration';
      return;
  }
  
  function didntRegister(x) {
	 var errdiv = document.querySelector('#register-error-div');
     errdiv.innerHTML = 'Invalid Code'; 
  }

  function displayRadio(value) {
    var ids = [ '#login-form', '#forgot-form', '#signup-form', '#CompanyRegister-form' ];
    for ( var i = 0; i < ids.length; i++) {
      document.querySelector(ids[i]).style.display = value == i ? 'block'
          : 'none';
    }
  }

	function showPrivacy() {
		document.querySelector('#privacy-policy').style.display='block';
		document.querySelector('#TOS').style.display='none';
		return false;
	}
	function showTOS() {
		$( '#TOS' ).load('u/tos.html', function() {
		document.querySelector('#privacy-policy').style.display='none';
		document.querySelector('#TOS').style.display='block';
		return false;
	});
	}
	
  function buttonRadio(value) {
    var ids = [ '#login-button', '#signup-button' ];
    for ( var i = 0; i < ids.length; i++) {
      var e = document.querySelector(ids[i]);
      if (value == i) {
        e.disabled = true;
        e.className = 'btn btn-home';
      } else {
        e.disabled = false;
        e.className = 'btn btn-home btn-success';
      }
    }
  }

  function loginForm() {
    /* This hack is a workaround for the Chrome handling of required attributes */
    var qs = document.querySelectorAll("#login-form input[requiredx]");
    for ( var i = 0; i < qs.length; i++) {
      qs[i].removeAttribute("requiredx");
      qs[i].setAttribute("required", false);
    }
    displayRadio(0);
    buttonRadio(0);
  }

  function forgotForm() {
    /* This hack is a workaround for the Chrome handling of required attributes */
    var qs = document.querySelectorAll("#login-form input[required]");
    for ( var i = 0; i < qs.length; i++) {
      qs[i].removeAttribute("required");
      qs[i].setAttribute("requiredx", false);
    }
    displayRadio(1);
    buttonRadio(2);
  }

  function signupForm() {
    displayRadio(2);
    buttonRadio(1);
  }
  
  function registerForm() {
    displayRadio(3);
    buttonRadio(1);
  }

  function doForgot() {
    var u = document.querySelector("#forgot-form input[name=username]").value;
	loginForm()
	var fed = document.querySelector("#login-error-div");
	fed.innerHTML = "An email to reset your password has been sent";
    SWBrijj.forgot(u, [ didForget, forgetError ]);
  }

  function forgetError(x) {
    var fed = document.querySelector("#forgot-error-div");
  }
  function didForget(x) {
    var fed = document.querySelector("#login-error-div");
    if (x) {
      fed.innerHTML = "An email to reset your password has been sent";
    }
  }

  function checkPassword() {

    if (document.registerform.password.value != document.registerform.confirmpassword.value) {
      document.registerform.confirmpassword
          .setCustomValidity('Passwords must match.');
    } else {
      document.registerform.confirmpassword.setCustomValidity('');
	  
    }
  }
  
  function doPreregister() {
	var email = document.querySelector("#CompanyRegister-form input[name=companyEmail]").value;
	var cName = document.querySelector("#CompanyRegister-form input[name=companyName]").value;
	var pName = document.querySelector("#CompanyRegister-form input[name=personalName]").value;
    SWBrijj.companyPreregister(email, cName, pName, [didPreregister, failedPreregister]);
  }
  
  function didPreregister(x) {
	var fed = document.querySelector("#register-success-div");
	fed.innerHTML = "Thanks! We'll be in touch with sign up information."; 
  }
  
  function failedPreregister(x) {
	var fed = document.querySelector("#register-success-div");
	fed.innerHTML = "This email is already registered!."; 
  }
</script>
</head>
<body>
  <div class="container">
    <div class="row-fluid">
      <section id="topbar">
        <div class="span12" id="homenav">
          <a href="index.html"><img src="img/logo2.png" id="homelogo" alt="ShareWave Logo"></a>
          <div class="btn-toolbar pull-right">
            <button id='login-button' class="btn btn-home" type="button" disabled onclick="loginForm()">Login</button>
            <button id='signup-button' class="btn btn-home btn-success" type="button" onclick="registerForm()">Sign Up</button>
          </div>
        </div>
      </section>
    </div>
    <div class="row-fluid">
      <section id="corenav">
        <div class="span12 navbar">
          <div>
            <ul class="nav">
              <li><a href="#">FOR COMPANIES</a></li>
              <li><a href="#">FOR FUNDERS</a></li>
              <li><a href="#">ABOUT US</a></li>
            </ul>
          </div>
        </div>
      </section>
    </div>
    <div class="row-fluid">
      <section>
        <div id="login-form" class="span12 pagination-centered">
          <br>
          <h1 id="Greeting"></h1>
          <div id="login-error-div" class="text-error"></div>
          <form id="login" class="center" action="" method="post" onsubmit="doLogin(); return false;">
            <fieldset>
              <label class="loginLabel">Email:</label> <input required class="loginInput" tabindex="1"
                autocapitalize="off" name="username" type="email"> <label class="loginLabel">Password:</label> <input
                required class="loginInput" id="login_password" tabindex="2" name="password" type="password">
              <a id="forgotButton" class="btn" onClick="forgotForm(); return false;">Forgot Your Password?</a>
              <button type="submit" class="btn btn-success loginButton" tabindex="3">Sign in</button>
              <br>
            </fieldset>
          </form>
        </div>
        <div id="forgot-form" style="display: none" class="span12 pagination-centered">
          <br>
          <h1>Forgot your password?</h1>
          <div id="forgot-error-div" class="text-error"></div>
          <form id="login" class="center" action="" method="post" onsubmit="doForgot(); return false;">
            <fieldset>
              <label class="loginLabel">Email:</label> <input required class="loginInput" placeholder="email" tabindex="1"
                autocapitalize="off" name="username" type="email"> <br>
              <button type="submit" class="btn btn-success loginButton" tabindex="3">Reset my password</button>
              <br>
            </fieldset>
          </form>
        </div>
        <div id='signup-form' style='display: none' class="span12 pagination-centered">
          <br>
          <h1 id="registerTitle">Welcome, we're excited to get you on board.</h1>
          <div id="register-error-div" class="text-error"></div>
          <form name="registerform" id="login" class="center" action="" method="post" onsubmit="doRegister(); return false;">
            <fieldset>
              <label class="loginLabel">Email:</label> <input required class="loginInput" tabindex="1"
                autocapitalize="off" name="investoremail" type="text" disabled="true"> 
                
              <label class="loginLabel">First Name:</label> 
              <input required class="loginInput" tabindex="2" autocapitalize="off" name="firstname" type="text">
                
              <label class="loginLabel">Last Name:</label> 
              <input required class="loginInput" tabindex="3" autocapitalize="off" name="lastname" type="text"> 
                
                <label class="loginLabel">Password:</label> <input
                required class="loginInput" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])\w{6,}"
                id="password1" tabindex="4" name="password" type="password"
                onchange="this.setCustomValidity(this.validity.patternMismatch ? 'Password must contain at least 6 characters, including UPPER/lowercase and numbers' : '');
  if(this.checkValidity()) form.confirmpassword.pattern = this.value;">
              <label class="loginLabel">Confirm Password:</label> <input required class="loginInput"
                pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])\w{6,}" id="register_password" tabindex="5"
                name="confirmpassword" type="password"
                onchange="this.setCustomValidity(this.validity.patternMismatch ? 'Please enter the same Password as above' : '');">
                
              <label class="checkbox registerBox"> <input type="checkbox" required name="TOSBox"> I agree to the <span class='hreffy'
                onClick='return showTOS();'>Terms of Use</span> &amp; <span class='hreffy' onClick='return showPrivacy();'>Privacy Policy</span>
                </label>
              <label class="checkbox registerBox"> <input type="checkbox" required name="electBox"> I agree to use fully electronic
                communications
              </label>
              <button type="submit" class="loginButton btn btn-success" tabindex="6">Get
                Started</button>
              <br>
            </fieldset>
          </form>
        </div>
        <div id="CompanyRegister-form" style='display: none' class="span12 pagination-centered">
          <br>
          <h1>Company registration</h1>
          <div id="register-success-div" class="text-error"></div>
          <form id="login" class="center" action="" method="post" onsubmit="doPreregister(); return false;">
            <fieldset>
              <label class="loginLabel">Company Name:</label> 
              <input required class="loginInput" tabindex="1" autocapitalize="off" name="companyName" type="text"> 
              <label class="loginLabel">Email:</label> 
              <input required class="loginInput" id="login_password" tabindex="2" name="companyEmail" type="text">
              <label class="loginLabel">Name:</label> 
              <input required class="loginInput" id="login_password" tabindex="2" name="personalName" type="text">
            </fieldset>
              <button type="submit" class="btn btn-success loginButton" tabindex="3">Register</button>
          </form>
        </div>
      </section>
    </div>

<div id='privacy-policy' class='boilerplate' style='display:none;'>
<h2>Privacy Policy</h2>

<p>When accessing our Website, [NAME] will learn certain information about you during your visit. How we will handle information we learn about you depends upon what you do when visiting our site.</p>

<p>If you visit our site to read or download information on our pages, we collect and store only the following information about you:</p>

<p>1. The name of the domain from which you access the Internet<br />2. The date and time you access our site<br />3. The Internet address of the website you used to link directly to our site.<br />4. [DATA1]<br />5. [DATA2]</p>

<p>If you identify yourself by sending us an e-mail containing personal information, then the information collected will be solely used to respond to your message.</p>

<p>The information collected is for statistical purposes. [NAME] may use software programs to create summary statistics, which are used for such purposes as assessing the number of visitors to the different sections of our site, what information is of most and least interest, determining technical design specifications, and identifying system performance or problem areas.</p>

<p>For site security purposes and to ensure that this service remains available to all users, [NAME] uses software programs to monitor network traffic to identify unauthorized attempts to upload or change information, or otherwise cause damage.</p>

<p>[NAME] will not obtain personally-identifying information about you when you visit our site, unless you choose to provide such information to us, nor will such information be sold or otherwise transferred to unaffiliated third parties without the approval of the user at the time of collection.</p>

<p>Generated by: <a target="_blank" title="Northern Virginia Business Attorneys and Lawyers" href="http://www.generalcounsellaw.com">General Counsel, PC</a> and <a target="_blank" title="Small Business Attorneys and Lawyers" href="http://www.LegalRiver.com">Legal River</a>'s <a target="_blank" title="Privacy Policy Generator" href="http://privacy-policy-generator.legalriver.com">Privacy Policy Generator</a></p>
</div>

<div>

<div id='TOS' class='boilerplate' style='display:none;'>
</div>


    
    
  </div>
  <script src="../script/jquery.js"></script>
  <script src="script/bootstrap.js"></script>
  <script src="brijj/brijj.js"></script>
  
  <script>
   $(document).ready(function() {
	  var m = getParams();
	  var c = m['code']
	  var d = m['issuer']
	  if (d == "yes") {
		alert("we have a company!");  
	  }
	  else {
	  if (m['code'] != undefined) {
		  signupForm()
		  SWBrijj.formFillout(c, retrievedRegister);
	  }
	  };
	  
		 jQuery('#login_password').keydown(function(){
			 var fed = document.querySelector("#login-error-div");
			 fed.innerHTML = "";
		});
		
  });
  </script>
</body>
</html>
