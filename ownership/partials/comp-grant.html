<link type="text/css" rel="stylesheet" href="/lib/select2/select2.css">
<link type="text/css" rel="stylesheet" href="/ownership/css/captable.css">
<link href="/lib/introjs/introjs.css" rel="stylesheet">
<div class="maincontent">
    <div class="container dynamic-page">
        <!--
        <div modal="capShare" close="close()" options="shareopts">
            <div class="modalHeader">
                <span>Share Ownership Table</span>
                <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="close()"></span>
            </div>
            <div>
                <p>Shareholders only see their personal holdings by default, change this by visiting their profile
                to grant full access.
                </p>

                <form>
                    <ul>
                        <li>
                        <input ng-model="selectAll" ng-change="turnOnShares();" class="checkbox" type="checkbox">
                        <span>Name</span>
                        <span>Email</span>
                        </li>
                        <li ng-repeat="row in rows | shareList">
                        <input class="checkbox" ng-model="row.send" type="checkbox" tabindex="-1">
                        <span class="capshareNames">{{row.name}}</span>
                        <input ng-class="{'content':!row.email, 'error':emailCheck(row.send, row.email)}"
                        ng-disabled="row.emailkey" ng-model="row.email" ng-change="row.send = autoCheck(row.email)">
                        </li>
                    </ul>
                </form>
            </div>
            <div class="modal-footer">
                <div class="pull-left standard-button gray">
                    <button class="btn" ng-click="close();">Cancel</button>
                </div>
                <div class="standard-button green">
                    <button class="btn" ng-disabled="checkInvites();" ng-click="close(); sendInvites();">Submit</button>
                </div>
            </div>
        </div>

        <div modal="issueModal" close="iclose();" options="opts">
            <div class="modalHeader">
                <span>Updating Issue?</span>
                <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="iclose(); irevert(changedIssue);"></span>
            </div>
            <div class="modalText">
                <form>
                    <p>There are transactions in this issue with different values.<br> Making this change will override them,
                    are
                    you sure you<br> want to continue?</p>
                </form>
            </div>
            <div class="modal-footer">
                <div class="pull-left standard-button gray">
                    <button class="btn" ng-click="iclose(); irevert(changedIssue);">No</button>
                </div>
                <div class="standard-button green">
                    <button class="btn" ng-click="iclose(); saveIssue(changedIssue, changedIssueField);">Yes</button>
                </div>
            </div>
        </div>

        <div modal="tranDelete" close="deleteclose();" options="opts">
            <div class="modalHeader">
                <span>Delete?</span>
                <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="deleteclose();"></span>
            </div>
            <div class="modalText">
                <form>
                    <p>Are you sure you want to delete this transaction?</p>
                    <br>
                </form>
            </div>
            <div class="modal-footer">
                <div class="pull-left standard-button gray">
                    <button class="btn" ng-click="deleteclose(); revertTran(deleteTran);">No</button>
                </div>
                <div class="standard-button green">
                    <button class="btn" ng-click="deleteclose(); manualdeleteTran(deleteTran);">Yes</button>
                </div>
            </div>
        </div>

        <div modal="capDelete" close="dclose(); revertIssue(missue);" options="opts">
            <div class="modalHeader">
                <span>Delete?</span>
                <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="dclose(); revertIssue(missue);"></span>
            </div>
            <div class="modalText">
                <form>
                    <p>Do you want to delete this issue, including all associated transactions?</p>
                    <br>
                </form>
            </div>
            <div class="modal-footer">
                <div class="pull-left standard-button gray">
                    <button class="btn" ng-click="dclose(); revertIssue(missue);">No</button>
                </div>
                <div class="standard-button green">
                    <button class="btn" ng-click="dclose(); deleteIssue(missue);">Yes</button>
                </div>
            </div>
        </div>
        -->

        <div class="row-fluid">
            <div class="row-fluid" ng-click="resetSideBar();">
                <div class="captable-controls subnav-controls">
                    <div>
                        <div class="pull-left" ng-show="editMode && issues.length!==0">
                            <span>View by</span>
                            <ul class="dropdown-list drop-selector">
                                <li class="dropdown standard">
                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                    {{ optionView }}
                                </a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a ng-click="setView('Security')" class="button">
                                            Security
                                        </a>
                                    </li>
                                    <li>
                                        <a ng-click="setView('Person')" class="button">
                                            Person
                                        </a>
                                    </li>
                                </ul>
                                </li>
                            </ul>
                        </div>
                        <div ng-show="false" class="pull-right">
                            <div class="standard-button">
                                <button ng-click="modalUp();" class="btn">Share</span>
                            </button>
                        </div>
                    </div>
                    <div class="box-button pull-right"
                         ng-show="issues.length!==0"
                         ng-class="{'disabledme': companyIsZombie()}"
                         ng-click="companyIsZombie() || editViewToggle();"
                         data-placement="bottom" bs-tooltip="zombiemessage">
                        <ul>
                            <li>
                                <span ng-show="togglename() == 'View'"
                                      data-icon="&#xe001;"
                                      aria-hidden="true">
                                </span>
                                <span ng-show="togglename() == 'Edit'"
                                      data-icon="&#xe00e;"
                                      aria-hidden="true">
                                </span>
                            </li>
                            <li>
                                <span>{{togglename()}}</span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="DivHelper"></div>
            </div>
        </div>

        <div ng-style="viewportheight"
             class="span8 docLibrary leftBlock"
             style="overflow-x: auto">
            <table class="tableView bodyText grant-table"
                   ng-show="issues.length===0 && done">
                <tbody class="empty-table">
                <tr>
                    <td>
                        <div>
                            Welcome!
                            <a href="/app/ownership/company-captable"
                               class="link">
                                Create an options security
                            </a> on your capitalization table to manage
                            your grants
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
            <div class="row-fluid">
                <table class="tableView bodyText grant-table"
                       ng-class="{'viewmode': editMode}"
                       ng-show="issues.length!==0 && optionView == 'Security'">
                    <tr class="column-label">
                        <th></th>
                        <th></th>
                        <th>Granted</th>
                        <th>Vested</th>
                        <th>Forfeited</th>
                        <th>Exercised</th>
                    </tr>
                    <tbody ng-hide="((!issue.trans || issue.trans.length==1) && editMode)"
                           ng-repeat="issue in issues">
                    <tr class="status-row">
                        <td class="status-toggle pointer"
                            ng-class="{'status-toggle-on': issue.shown}"
                            ng-click="opendetails(issue.issue, 'issue')">
                            <span ng-hide="issue.shown || !issue.trans"
                                  data-icon="&#xe017;" aria-hidden="true">
                            </span>
                            <span ng-show="issue.shown && issue.trans"
                                  data-icon="&#xe01c;" aria-hidden="true">
                            </span>
                        </td>
                        <td ng-class="{'selectablerow': editMode}"
                            ng-click="!editMode || getActiveIssue(issue, '', 'view')">
                            <input ng-show="!editMode"
                                   placeholder="Add new security"
                                   ui-event="{focus: 'getActiveIssue(issue)',
                                              blur: 'saveIssue(issue, \'issue\')'}"
                                   ng-model="issue.issue">
                            <span ng-show="editMode">
                                {{issue.issue}}
                            </span>
                        </td>
                        <td>{{formatAmount(issueGranted(issue))}}</td>
                        <td>{{formatAmount(issueVested(issue))}}</td>
                        <td>{{formatAmount(issueActions(issue, 'forfeited'))}}</td>
                        <td>{{formatAmount(issueActions(issue, 'exercised'))}}</td>
                    </tr>
                    <tr class="transaction-rows"
                        ng-show="issue.shown && !editMode"
                        ng-repeat="tran in issue.trans">
                        <td></td>
                        <td>
                            <input bs-typeahead="rownames"
                                   placeholder="Add new investor"
                                   ng-model="tran.investor"
                                   ng-change="fauxupdating(tran)"
                                   ui-event="{focus: 'getActiveTransaction(tran)',
                                              blur: 'updateName(tran)'}">
                        </td>
                        <td>
                            <input maxlength="16" placeholder="options"
                                   ng-disabled="!tran.investor"
                                   ui-event="{focus: 'getActiveTransaction(tran)',
                                              blur: 'saveTran(activeTran)'}"
                                   ng-model="tran.units">
                        </td>
                        <td ng-click="getActiveTransaction(tran, 'vested')">
                            <span>
                                {{formatAmount(transactionVested(tran.vested))}}
                            </span>
                        </td>
                        <td>
                            <input maxlength="16" placeholder="options"
                                   ng-disabled="!tran.investor || !tran.units"
                                   ui-event="{focus: 'getActiveTransaction(tran, \'forfeited\')',
                                              blur: 'grantUpdateLR(tran, \'forfeited\')'}"
                                   ng-model="tran.forfeited">
                        </td>
                        <td>
                            <input maxlength="16" placeholder="options"
                                   ng-disabled="!tran.investor || !tran.units"
                                   ui-event="{focus: 'getActiveTransaction(tran, \'exercised\')',
                                              blur: 'grantUpdateLR(tran, \'exercised\')'}"
                                   ng-model="tran.exercised">
                        </td>
                    </tr>
                    <tr class="transaction-rows"
                        ng-show="issue.shown && editMode"
                        ng-repeat="tran in issue.trans | noempty">
                        <td class="viewField"></td>
                        <td ng-class="{fieldSelected: tran.fields[0],
                                       hoverable: tran.investor}"
                            ng-click="getActiveTransaction(tran, '', 'view')">
                            <span>{{tran.investor}}</span>
                        </td>
                        <td ng-class="{fieldSelected: tran.fields[0],
                                       hoverable: tran.units}"
                            ng-click="getActiveTransaction(tran, '', 'view')">
                            <span>{{formatAmount(tran.units)}}</span>
                        </td>
                        <td ng-class="{fieldSelected: tran.fields[1],
                                       hoverable: (tran.vested.length > 0)}"
                            ng-click="getActiveTransaction(tran, 'vested', 'view')">
                            <span>
                                {{formatAmount(transactionVested(tran.vested))}}
                            </span>
                        </td>
                        <td ng-class="{fieldSelected: tran.fields[2],
                                       hoverable: tran.forfeited}"
                            ng-click="getActiveTransaction(tran, 'forfeited', 'view')">
                            <span>{{formatAmount(tran.forfeited)}}</span>
                        </td>
                        <td ng-class="{fieldSelected: tran.fields[3],
                                       hoverable: tran.exercised}"
                            ng-click="getActiveTransaction(tran, 'exercised', 'view')">
                            <span>{{formatAmount(tran.exercised)}}</span>
                        </td>
                    </tr>
                    </tbody>
                    <tr class="total-row">
                        <td>Total</td>
                        <td colspan="5"></td>
                    </tr>
                    <tr class='tablefooter'>
                        <td></td>
                        <td></td>
                        <td>
                            <input disabled
                                   value="{{formatAmount(footerAction('units', issues), 'zero')}}">
                        </td>
                        <td>
                            <input disabled
                                   value="{{formatAmount(footerAction('vested', issues), 'zero')}}">
                        </td>
                        <td>
                            <input disabled
                                   value="{{formatAmount(footerAction('forfeited', issues), 'zero')}}">
                        </td>
                        <td>
                            <input disabled
                                   value="{{formatAmount(footerAction('exercised', issues), 'zero')}}">
                        </td>
                    </tr>
                </table>

                <table class="tableView bodyText grant-table viewmode"
                       ng-show="issues.length!==0 && optionView == 'Person'">
                    <tr class="column-label">
                        <th></th>
                        <th></th>
                        <th>Granted</th>
                        <th>Vested</th>
                        <th>Forfeited</th>
                        <th>Exercised</th>
                    </tr>
                    <tbody ng-repeat="investor in investorLed">
                    <tr class="status-row">
                        <td class="status-toggle pointer"
                            ng-class="{'status-toggle-on': investor.shown}"
                            ng-click="opendetails(investor.name, 'investor')">
                            <span ng-hide="investor.shown"
                                  data-icon="&#xe017;" aria-hidden="true">
                            </span>
                            <span ng-show="investor.shown"
                                  data-icon="&#xe01c;" aria-hidden="true">
                            </span>
                        </td>
                        <td>
                            <input disabled ng-model="investor.name">
                        </td>
                        <td>{{formatAmount(issueGranted(investor))}}</td>
                        <td>{{formatAmount(issueVested(investor))}}</td>
                        <td>{{formatAmount(issueActions(investor, 'forfeited'))}}</td>
                        <td>{{formatAmount(issueActions(investor, 'exercised'))}}</td>
                    </tr>
                    <tr class="transaction-rows"
                        ng-show="investor.shown && editMode"
                        ng-repeat="tran in investor.trans | noempty">
                        <td class="viewField"></td>
                        <td ng-class="{fieldSelected: tran.fields[0],
                                       hoverable: tran.investor}"
                            ng-click="getActiveTransaction(tran, '', 'view')">
                            <span>{{tran.issue}}</span>
                        </td>
                        <td ng-class="{fieldSelected: tran.fields[0],
                                       hoverable: tran.units}"
                            ng-click="getActiveTransaction(tran, '', 'view')">
                            <span>{{formatAmount(tran.units)}}</span>
                        </td>
                        <td ng-class="{fieldSelected: tran.fields[1],
                                       hoverable: (tran.vested.length > 0)}"
                            ng-click="getActiveTransaction(tran, 'vested', 'view')">
                            <span>{{formatAmount(transactionVested(tran.vested))}}</span>
                        </td>
                        <td ng-class="{fieldSelected: tran.fields[2],
                                       hoverable: tran.forfeited}"
                            ng-click="getActiveTransaction(tran, 'forfeited', 'view')">
                            <span>{{formatAmount(tran.forfeited)}}</span>
                        </td>
                        <td ng-class="{fieldSelected: tran.fields[3],
                                       hoverable: tran.exercised}"
                            ng-click="getActiveTransaction(tran, 'exercised', 'view')">
                            <span>{{formatAmount(tran.exercised)}}</span>
                        </td>
                    </tr>
                    </tbody>
                    <tr class="total-row">
                        <td>Total</td>
                        <td colspan="5"></td>
                    </tr>
                    <tr class='tablefooter'>
                        <td></td>
                        <td></td>
                        <td>
                            <input disabled
                                   value="{{formatAmount(footerAction('units', issues), 'zero')}}">
                        </td>
                        <td>
                            <input disabled
                                   value="{{formatAmount(footerAction('vested', issues), 'zero')}}">
                        </td>
                        <td>
                            <input disabled
                                   value="{{formatAmount(footerAction('forfeited', issues), 'zero')}}">
                        </td>
                        <td>
                            <input disabled
                                   value="{{formatAmount(footerAction('exercised', issues), 'zero')}}">
                        </td>
                    </tr>
                </table>
            </div>
        </div>


        <div ng-style="viewportheight" class="span4 capright">
            <div ng-switch on="sideBar">
                <span ng-switch-when="1">
                    <div class="capGuide global"
                         ng-show="mode == 1 && !editMode">
                        <div class="rightTitle security-type">
                            <span>Investor</span>
                            <input disabled
                                   ng-model="activeTran.investor">
                        </div>
                        <p class="rightTitle">
                            <span>Date</span>
                            <input ng-show="mode == 1 && !editMode"
                                   ng-disabled="toggleView();"
                                   id="date{{activeTran.$$hashKey}}"
                                   ui-event="{keydown: 'saveTranDate(activeTran, \'date\', $event)',
                                              blur: 'saveTranDate(activeTran, \'date\', \'blur\')'}"
                                   ng-change="saveTranDate(activeTran, 'date')"
                                   type="text"
                                   ng-model="activeTran.date"
                                   data-date-format={{settings.lowercasedate}}
                                   bs-datepicker>
                        </p>
                        <p class="rightTitle">
                            <span>Options</span>
                            <input ui-event="{blur: 'saveTran(activeTran)'}"
                                   ng-model="activeTran.units">
                        </p>
                        <p class="rightTitle">
                            <span>Strike Price</span>
                            <input ui-event="{blur: 'saveTran(activeTran)'}"
                                   ng-model="activeTran.price">
                        </p>
                        <div ng-show="activeTran.terms == null &&
                                      activeTran.vestingbegins == null &&
                                      activeTran.vestcliff == null &&
                                      activeTran.vestfreq == null"
                             class="rightTitle">
                            <span>Vesting Schedule</span>
                            <ul class="dropdown-list drop-selector">
                                <li class="dropdown standard">
                                    <a class="dropdown-toggle">
                                        <span class="invisible-drop">'</span>
                                    </a>
                                    <ul class="dropdown-menu">
                                        <li ng-repeat="i in schedules">
                                            <a ng-click="pickSchedule(i, activeTran)">
                                                {{i.name}}
                                            </a>
                                        </li>
                                        <li>
                                            <a ng-click="pickSchedule('!!', activeTran)">
                                                Custom Schedule
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                        <p ng-hide="activeTran.terms == null &&
                                    activeTran.vestingbegins == null &&
                                    activeTran.vestcliff == null &&
                                    activeTran.vestfreq == null"
                           class="rightTitle double">
                            <span>Vesting Term (months)</span>
                            <input ui-event="{blur: 'saveTran(activeTran)'}"
                                   ng-model="activeTran.terms">
                            <span class="tooltip-icon"
                                  data-icon="&#xe044;"
                                  aria-hidden="true"
                                  data-placement="top"
                                  bs-tooltip="captabletips.terms">
                            </span>
                        </p>
                        <p ng-hide="activeTran.terms == null &&
                                    activeTran.vestingbegins == null &&
                                    activeTran.vestcliff == null &&
                                    activeTran.vestfreq == null"
                           class="rightTitle double">
                            <span>Vesting Cliff (Months)</span>
                            <input ui-event="{blur: 'saveTran(activeTran)'}"
                                   ng-model="activeTran.vestingbeginsdisplay">
                            <span class="tooltip-icon"
                                  data-icon="&#xe044;"
                                  aria-hidden="true"
                                  data-placement="top"
                                  bs-tooltip="captabletips.vestingbegins">
                            </span>
                        </p>
                        <p ng-hide="activeTran.terms == null &&
                                    activeTran.vestingbegins == null &&
                                    activeTran.vestcliff == null &&
                                    activeTran.vestfreq == null"
                           class="rightTitle">
                            <span>Vesting Cliff %</span>
                            <input ui-event="{blur: 'saveTran(activeTran)'}"
                                   ng-model="activeTran.vestcliff">
                            <span class="tooltip-icon"
                                  data-icon="&#xe044;"
                                  aria-hidden="true"
                                  data-placement="top"
                                  bs-tooltip="captabletips.vestcliff">
                            </span>
                        </p>
                        <div ng-hide="activeTran.terms == null &&
                                      activeTran.vestingbegins == null &&
                                      activeTran.vestcliff == null &&
                                      activeTran.vestfreq == null"
                             class="rightTitle double">
                            <span>Post Cliff Frequency</span>
                            <ul class="dropdown-list drop-selector">
                                <li class="dropdown standard">
                                    <a class="dropdown-toggle">
                                        {{activeTran.vestfreq}}
                                        <span class="invisible-drop">'</span>
                                    </a>
                                    <ul class="dropdown-menu">
                                        <li ng-repeat="i in freqtypes">
                                            <a ng-click="saveTranAssign(activeTran, 'vestfreq', i)">
                                                {{i}}
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                            <span class="tooltip-icon"
                                  data-icon="&#xe044;"
                                  aria-hidden="true"
                                  data-placement="top"
                                  bs-tooltip="captabletips.vestfreq">
                            </span>
                        </div>
                        <span class="blue-link delete-link grant-link"
                              ng-click="tranDeleteUp(activeTran);">
                            Delete Transaction
                        </span>
                    </div>
                    <div class="capGuide grants"
                         ng-show="mode == 2 && !editMode">
                        <h2>Forfeit Information</h2>
                        <ul>
                            <li class="grant-list-edit"
                                ng-repeat="act in activeTran.activeAct
                                           | grantSelect:'forfeited'">
                                <p class="rightTitle">
                                    <span>Date</span>
                                    <input ng-change="saveGrant(act, 'forfeited')"
                                           ng-model="act.date"
                                           data-date-format={{settings.lowercasedate}}
                                           bs-datepicker>
                                </p>
                                <p class="rightTitle">
                                    <span>Shares</span>
                                    <input ui-event="{blur: 'saveGrant(act, \'forfeited\')'}"
                                           ng-model="act.unit">
                            </li>
                        </ul>
                    </div>
                    <div class="capGuide grants"
                         ng-show="mode == 3 && !editMode">
                        <h2>Exercise Information</h2>
                        <ul>
                            <li class="grant-list-edit"
                                ng-repeat="act in activeTran.activeAct
                                           | grantSelect:'exercised'">
                                <p class="rightTitle">
                                    <span>Date</span>
                                    <input ng-change="saveGrant(act, 'exercised')"
                                           ng-model="act.date"
                                           data-date-format={{settings.lowercasedate}}
                                           bs-datepicker>
                                </p>
                                <p class="rightTitle">
                                    <span>Shares</span>
                                    <input ui-event="{blur: 'saveGrant(act, \'exercised\')'}"
                                       n   ng-model="act.unit">
                                </p>
                            </li>
                        </ul>
                    </div>

                    <div class="capGuide grants" ng-show="mode == 4 && !editMode">

                        <h2>Vested Information</h2>

                        <ul class="grant-list-view">
                            <li>
                            <span>Date</span>
                            <span>Shares</span>
                            </li>
                            <li ng-repeat="grant in activeTran.vested">
                            <span ng-bind="grant.date | date:settings.shortdate"></span>
                            <span ng-bind="formatAmount(grant.units)"></span>
                            </li>
                        </ul>
                    </div>


                </span>

                <span ng-switch-when="4">

                    <div class="capGuide grants" ng-show="mode == 1 && !editMode">

                        <div class="rightTitle security-type">
                            <span>Security name</span>
                            <input ng-disabled="toggleView();" ui-event="{blur : 'saveIssue(activeIssue, \'issue\')'}"
                            ng-model="activeIssue.issue"
                            onkeydown="testForEnter();">
                        </div>

                        <p class="rightTitle"><span>Issue Date</span><input ng-disabled="toggleView();"
                        id="date{{activeIssue.$$hashKey}}"
                        ng-change="saveIssueCheckDate(activeIssue, 'date')"
                        ui-event="{keydown:'saveIssueCheckDate(activeIssue, \'date\', $event)', blur:'saveIssueCheckDate(activeIssue, \'date\', \'blur\')'}"
                        type="text"
                        ng-model="activeIssue.date"
                        data-date-format={{settings.lowercasedate}}
                        bs-datepicker
                        onkeydown="testForEnter();"></p>

                        <div class="rightTitle double"><span>Underlying Security</span>
                            <ul class="dropdown-list drop-selector">
                                <li class="dropdown standard">
                                <a class="dropdown-toggle">
                                    {{activeIssue.optundersec | maxLength}}<span class="invisible-drop">'</span>
                                </a>
                                <ul ng-hide="toggleView();" class="dropdown-menu">
                                    <li ng-repeat="i in equityissues">
                                    <a ng-click="saveIssueAssign(activeIssue, 'optundersec', i)">{{i | maxLength}}</a>
                                    </li>
                                </ul>
                                </li>
                            </ul>
                            <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                                bs-tooltip="captabletips.optundersec"></span>
                        </div>

                        <p class="rightTitle"><span>Total Authorized</span><input ng-disabled="toggleView();"
                        ui-event="{blur : 'saveIssue(activeIssue, \'totalauth\')'}"
                        ng-model="activeIssue.totalauth"
                        onkeydown="testForEnter();">
                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                            bs-tooltip="captabletips.totalauth"></span>
                        </p>

                        <p class="rightTitle"><span>Total Granted</span><input disabled
                        value="{{totalGranted(activeIssue.issue, trans);}}">
                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                            bs-tooltip="captabletips.totalgranted"></span>
                        </p>

                        <p class="rightTitle"><span>Strike Price</span><input ng-disabled="toggleView();"
                        ui-event="{blur : 'saveIssueCheck(activeIssue, \'price\')'}"
                        ng-model="activeIssue.price"
                        onkeydown="testForEnter();">
                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                            bs-tooltip="captabletips.price"></span>
                        </p>

                        <p class="rightTitle double"><span>Vesting Term (months)</span><input ng-disabled="toggleView();"
                        ui-event="{blur : 'saveIssueCheck(activeIssue, \'terms\')'}"
                        ng-model="activeIssue.terms"
                        onkeydown="testForEnter();">
                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                            bs-tooltip="captabletips.terms"></span>
                        </p>

                        <p class="rightTitle double"><span>Vesting Cliff (Months)</span><input type="text" ui-event="{blur : 'saveIssueCheck(activeIssue, \'vestingbegins\')'}" ng-model="activeIssue.vestingbeginsdisplay">
                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                            bs-tooltip="captabletips.vestingbegins"></span>
                        </p>

                        <p class="rightTitle"><span>Vesting Cliff %</span><input ng-disabled="toggleView();"
                        ui-event="{blur : 'saveIssueCheck(activeIssue, \'vestcliff\')'}"
                        ng-model="activeIssue.vestcliff"
                        onkeydown="testForEnter();">
                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                            bs-tooltip="captabletips.vestcliff"></span>
                        </p>

                        <div class="rightTitle double"><span>Post Cliff Frequency</span>
                            <ul class="dropdown-list drop-selector">
                                <li class="dropdown standard">
                                <a class="dropdown-toggle">
                                    {{activeIssue.vestfreq}}<span class="invisible-drop">'</span>
                                </a>
                                <ul ng-hide="toggleView();" class="dropdown-menu">
                                    <li ng-repeat="i in freqtypes">
                                    <a ng-click="saveIssueAssign(activeIssue, 'vestfreq', i)">{{i}}</a>
                                    </li>
                                </ul>
                                </li>
                            </ul>
                            <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                                bs-tooltip="captabletips.vestfreq"></span>
                        </div>

                        <span class="blue-link delete-link grant-link" ng-click="deleteIssueButton(activeIssue);">Delete security</span>
                    </div>

                </span>

                <span ng-switch-when="5">

                    <div class="capGuide grants" ng-show="mode == 1 && editMode">

                        <p class="belowTitle"><span ng-bind="activeIssue.issue"></span><span>Security Name</span></p>

                        <p class="belowTitle"><span
                            ng-bind="activeIssue.date  | date:settings.shortdate"></span><span>Date</span></p>

                        <p ng-show="activeIssue.optundersec" class="belowTitle"><span
                            ng-bind="activeIssue.optundersec"></span><span tooltip-placement="top"
                            tooltip="The security each granted share will convert to upon exercise">Underlying Security</span>
                        </p>

                        <p ng-show="activeIssue.totalauth" class="belowTitle"><span
                            ng-bind="formatAmount(activeIssue.totalauth)"></span><span tooltip-placement="top"
                            tooltip="The sum total of shares authorized to be issued">Total Authorized</span>
                        </p>

                        <p ng-show="totalGranted(activeIssue.issue, trans)" class="belowTitle"><span
                            ng-bind="formatAmount(totalGranted(activeIssue.issue, trans))"></span><span
                            tooltip-placement="top" tooltip="The sum total of shares granted">Total Granted</span>
                        </p>

                        <p ng-show="activeIssue.price" class="belowTitle"><span
                            ng-bind="formatDollarAmount(activeIssue.price)"></span><span tooltip-placement="top"
                            tooltip="The price each granted share can be purchased at when vested">Strike Price</span>
                        </p>

                        <p ng-show="activeIssue.terms" class="belowTitle"><span ng-bind="activeIssue.terms"></span><span
                            tooltip-placement="top" tooltip="The total number of months until fully vested">Vesting Term (Months)</span>
                        </p>

                        <p ng-show="activeIssue.vestingbegins" class="belowTitle"><span
                            ng-bind="activeIssue.vestingbeginsdisplay"></span><span
                            tooltip-placement="top" tooltip="The date the vesting cliff percentage becomes vested">Vesting Cliff (Months)</span>
                        </p>

                        <p ng-show="activeIssue.vestcliff" class="belowTitle"><span
                            ng-bind="activeIssue.vestcliff"></span><span tooltip-placement="top"
                            tooltip="The percentage of granted shares that are considered vested on the cliff date">Vesting Cliff %</span>
                        </p>

                        <p ng-show="activeIssue.vestfreq" class="belowTitle"><span ng-bind="activeIssue.vestfreq"></span><span
                            tooltip-placement="top"
                            tooltip="The frequency that granted shares vest after the cliff date, distributed evenly by frequency until the vesting term ends">Post Cliff Frequency</span>
                        </p>

                    </div>

                </span>

                <!-- Explain -->
                <span ng-switch-when="3">
                    <div class="capGuide grants" ng-show="mode == 1 && editMode">

                        <p ng-show="activeTran.investor" class="belowTitle"><span ng-bind="activeTran.investor"></span><span>Investor</span></p>

                        <p ng-show="activeTran.date" class="belowTitle"><span
                            ng-bind="activeTran.date | date:settings.shortdate"></span><span>Date</span></p>

                        <p ng-show="activeTran.units" class="belowTitle"><span
                            ng-bind="formatAmount(activeTran.units)"></span><span>Shares</span></p>

                        <p ng-show="activeTran.optundersec" class="belowTitle"><span
                            ng-bind="activeTran.optundersec"></span>
                        <span tooltip="The security each granted share will convert to upon exercise" tooltip-placement="right" class="forTooltip">Underlying Security</span>
                        </p>

                        <p ng-show="activeTran.price" class="belowTitle"><span
                            ng-bind="formatDollarAmount(activeTran.price)"></span><span tooltip-placement="right"
                            tooltip="The price each granted share can be purchased at when vested" class="forTooltip">Strike Price</span>
                        </p>

                        <p ng-show="activeTran.terms" class="belowTitle"><span ng-bind="activeTran.terms"></span><span
                            tooltip-placement="right" class="forTooltip" tooltip="The total number of months until fully vested">Vesting Term (months)</span>
                        </p>

                        <p ng-show="activeTran.vestingbegins" class="belowTitle"><span
                            ng-bind="activeTran.vestingbeginsdisplay"></span><span
                            tooltip-placement="right" class="forTooltip" tooltip="The date the vesting cliff percentage becomes vested">Vesting Cliff (Months)</span>
                        </p>

                        <p ng-show="activeTran.vestcliff" class="belowTitle"><span ng-bind="activeTran.vestcliff"></span><span
                            tooltip-placement="right"
                            tooltip="The percentage of granted shares that are considered vested on the cliff date" class="forTooltip">Vesting Cliff %</span>
                        </p>

                        <p ng-show="activeTran.vestfreq" class="belowTitle"><span ng-bind="activeTran.vestfreq"></span><span
                            tooltip-placement="right"
                            tooltip="The frequency that granted shares vest after the cliff date, distributed evenly by frequency until the vesting term ends" class="forTooltip">Post Cliff Frequency</span>
                        </p>
                    </div>

                    <div class="capGuide grants" ng-show="mode == 2 && editMode">

                        <h2>Forfeit Information</h2>

                        <ul class="grant-list-view">
                            <li>
                            <span>Date</span>
                            <span>Options</span>
                            </li>
                            <li ng-show="act.unit" ng-repeat="act in activeTran.activeAct | grantSelect:'forfeited'">
                            <span ng-bind="act.date | date:settings.shortdate"></span>
                            <span ng-bind="act.unit"></span>
                            </li>
                        </ul>
                    </div>

                    <div class="capGuide grants" ng-show="mode == 3 && editMode">

                        <h2>Exercised Information</h2>

                        <ul class="grant-list-view">
                            <li>
                            <span>Date</span>
                            <span>Options</span>
                            </li>
                            <li ng-show="act.unit"
                            ng-repeat="act in activeTran.activeAct | grantSelect:'exercised'">
                            <span ng-bind="act.date | date:settings.shortdate"></span>
                            <span ng-bind="formatAmount(act.unit)"></span>
                            </li>
                        </ul>
                    </div>

                    <div class="capGuide grants" ng-show="mode == 4 && editMode">

                        <h2 style="margin-bottom: 0px;">Vested Information</h2>

                        <p style="margin-bottom: 15px;">Auto-calculated from vesting schedule</p>

                        <ul class="grant-list-view">
                            <li>
                            <span>Date</span>
                            <span>Options</span>
                            </li>
                            <li ng-repeat="grant in activeTran.vested">
                            <span ng-bind="grant.date | date:settings.shortdate"></span>
                            <span ng-bind="formatAmount(grant.units)"></span>
                            </li>
                        </ul>
                    </div>

                </span>

                <span ng-switch-when="2">
                    <p>Investor Email <input disabled ng-model="activeInvestorName"></p>
                </span>

                <span class="capGuide railpadding" ng-switch-default>
                    <h1 class="right-bar-header">Saved Vesting Schedules</h1>

                    <div ng-repeat="schedule in schedules" class="schedule-box">
                        <div>
                            <span ng-hide="schedule.shown" data-icon="&#xe017;" aria-hidden="true"
                                ng-click="showSchedule(schedule);"></span>
                            <span ng-show="schedule.shown" data-icon="&#xe01c;" aria-hidden="true"
                                ng-click="showSchedule(schedule);"></span>
                            <span>{{schedule.name}}</span>
                            <span class="delete-icon" data-icon="&#xe00c;" ng-click="deleteSchedule(schedule);"
                                aria-hidden="true"></span>
                        </div>
                        <div ng-show="schedule.shown">
                            <p ng-show="schedule.terms" class="belowTitle"><span ng-bind="schedule.terms"></span><span
                                tooltip-placement="top" tooltip="The total number of months until fully vested">Vesting Term (months)</span>
                            </p>

                            <p ng-show="schedule.vestingbegins" class="belowTitle"><span
                                ng-bind="schedule.vestingbegins"></span><span
                                tooltip-placement="top" tooltip="The date the vesting cliff percentage becomes vested">Vesting Cliff (Months)</span>
                            </p>

                            <p ng-show="schedule.vestcliff" class="belowTitle"><span ng-bind="schedule.vestcliff"></span><span
                                tooltip-placement="top"
                                tooltip="The percentage of granted shares that are considered vested on the cliff date">Vesting Cliff %</span>
                            </p>

                            <p ng-show="schedule.vestfreq" class="belowTitle"><span ng-bind="schedule.vestfreq"></span><span
                                tooltip-placement="top"
                                tooltip="The frequency that granted shares vest after the cliff date, distributed evenly by frequency until the vesting term ends">Post Cliff Frequency</span>
                            </p>
                        </div>
                    </div>

                    <div class="capGuide grants new-schedule" ng-show="newSchedule">
                        <div>
                            <p class="rightTitle"><span>Schedule Name</span><input ng-model="newschedule.name"
                            onkeydown="testForEnter();">

                            <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                                bs-tooltip="captabletips.name"></span>
                            </p>

                            <p class="rightTitle double"><span>Vesting Term (months)</span><input ng-model="newschedule.terms"
                            onkeydown="testForEnter();">

                            <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                                bs-tooltip="captabletips.terms"></span>
                            </p>

                            <p class="rightTitle double"><span>Vesting Cliff (Months)</span><input type="text"
                            ng-model="newschedule.vestingbegins">
                            <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                                bs-tooltip="captabletips.vestingbegins"></span>
                            </p>

                            <p class="rightTitle"><span>Vesting Cliff %</span><input ng-model="newschedule.vestcliff"
                            onkeydown="testForEnter();">
                            <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                                bs-tooltip="captabletips.vestcliff"></span>
                            </p>

                            <div class="rightTitle double"><span>Post Cliff Frequency</span>
                                <ul class="dropdown-list drop-selector">
                                    <li class="dropdown standard">
                                    <a class="dropdown-toggle">
                                        {{newschedule.vestfreq}}<span class="invisible-drop">'</span>
                                    </a>
                                    <ul ng-hide="toggleView();" class="dropdown-menu">
                                        <li ng-repeat="i in freqtypes">
                                        <a ng-click="assignFreq(i, newschedule);">{{i}}</a>
                                        </li>
                                    </ul>
                                    </li>
                                </ul>
                                <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top"
                                    bs-tooltip="captabletips.vestfreq"></span>
                            </div>

                            <div class="standard-button small-standard-button">
                                <button class="btn ng-binding" ng-disabled="newschedule.name == null || newschedule.name == ''"
                                    ng-click="createSchedule(newschedule);">Done
                                </button>
                            </div>

                        </div>
                    </div>

                    <div ng-hide="newSchedule || companyIsZombie()" class="standard-button">
                        <button id='a_grant_template' class="btn ng-binding" ng-click="addSchedule();">New Template</button>
                    </div>
                </span>
            </div>
        </div>
    </div>
</div>
</div>
