<link type="text/css" rel="stylesheet" href="/lib/select2/select2.css">
<link type="text/css" rel="stylesheet" href="/ownership/css/captable.css">
<link href="/lib/introjs/introjs.css" rel="stylesheet">
<div class="maincontent">
<div class="container dynamic-page">
<div modal="capShare" close="close()" options="transferopts">
    <div class="modalHeader">
        <span>Share Cap Table</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="close()"></span>
    </div>
    <div class="share-modal-main">
        <p>Select shareholders and their permissions
        </p>

        <div class="docLibrary full-width">
            <table class="captable tableView modal-table">
                <tbody>
                    <tr class="column-label">
                        <th>Name</th>
                        <th></th>
                        <th>Email</th>
                        <th>Permissions <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.permissions"></span></th>
                    </tr>
                </tbody>
                <tbody class="scrollable-body">
                    <tr ng-repeat="row in rows | shareList track by $index">
                        <td>
                            <button ng-class="{'selected':row.send}" ng-click="row.send = !row.send; row.permission = 'Personal'" ng-model="row.send" class="check-box-button"><span data-icon="&#xe023;" aria-hidden="true"></span></button>
                        </td>
                        <td style="width: 225px;">{{row.name}}</td>
                        <td style="width: 210px;"><input class="transfer-shares-input" ng-class="{'error':emailCheck(row.send, row.email)}"
                                   ng-disabled="row.emailkey" ng-model="row.email" ng-change="updateSendRow(row);"></td>
                        <td style="width: 210px;">
                            <ul class="dropdown-list drop-selector">
                                <li class="dropdown standard">
                                    <a class="dropdown-toggle">
                                        {{row.permission}}<span class="invisible-drop">'</span>
                                    </a>
                                    <ul class="dropdown-menu">
                                        <li><span ng-click="row.permission = 'Personal'">Personal</span></li>
                                        <li><span ng-click="row.permission = 'Full'">Full</span></li>
                                    </ul>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <p>Share with contacts not listed in your cap table</p>
        <div class="sharepeople-input">
            <input ui-select2="select2Options" ng-model="extraPeople">
        </div>
    </div>
    <div class="modal-footer">
        <div class="pull-left standard-button gray">
            <button class="btn" ng-click="close();">Cancel</button>
        </div>
        <div class="standard-button green">
            <button id='a_own_share_modal' class="btn" ng-disabled="checkInvites();" ng-click="close(); sendInvites();">Submit</button>
        </div>
    </div>
</div>

<div modal="capEditEmail" close="alterEmailModalClose()" options="opts">
    <div class="modalHeader">
        <span>Edit this row's email?</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="alterEmailModalClose()"></span>
    </div>
    <div class="modalText">
        <p>Changing the email address of this row will invite a new email to get a personal view of the captable.
            If the account associated with the old email has a personal view of the captable
            they will no longer be able to see it.
        </p>
        <div class="input-row">
            <p>Email Address</p>
            <input ng-model="newEmail">
        </div>
    </div>
    <div class="modal-footer">
        <div class="pull-left standard-button gray">
            <button class="btn" ng-click="alterEmailModalClose();">Cancel</button>
        </div>
        <div class="standard-button green">
            <button class="btn" ng-click="alterEmailModalClose(); alterEmail();">Change</button>
        </div>
    </div>
</div>
<div modal="evidenceModal" close="closeEvidenceModal()" options="opts">
    <div class="modalHeader">
        <span>Select Evidence</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="closeEvidenceModal()"></span>
    </div>
    <div class="modalText">
        <p>Explananation here</p>
        <div ng-repeat="item in activeIssue.evidence">
            <ul class="dropdown-list drop-selector">
                <li class="dropdown standard">
                    <a class="dropdown-toggle">
                        {{item.docname + item.investor | maxLength}}
                        <span class="invisible-drop">'</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li ng-repeat="e in availableEvidence(eligible_evidence, activeIssue.evidence) track by $index">
                            <a ng-click="saveEvidence(e, activeIssue)">
                                {{e.docname | maxLength}}
                            </a>
                        </li>
                    </ul> 
                </li>
            </ul>
        </div>
        <button class="icon-button" ng-click="addEvidence(activeIssue.evidence)">
            <span data-icon="&#xe053;" aria-hidden="true"></span>
        </button>
    </div>
    <div class="modal-footer">
        <div class="pull-left standard-button gray">
            <button class="btn" ng-click="closeEvidenceModal()">Cancel</button>
        </div>
        <div class="standard-button green">
            <button class="btn" ng-click="closeEvidenceModal(); updateEvidence();">Confirm</button>
        </div>
    </div>
</div>
<div modal="capMulti" close="mclose(); mReset();" options="opts">
    <div class="modalHeader">
        <span>Is this a new transaction?</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="mclose(); mReset();"></span>
    </div>
    <div class="modalText">
        <form>
            <p>Is this a new transaction, or do you want to modify the existing transaction?</p>
            <br>
            <div>
                <ul class="dropdown-list drop-selector">
                    <li class="dropdown standard">
                        <a class="dropdown-toggle">
                            <span ng-show="newtransaction">
                                {{newtransaction}}
                            </span>
                            <span ng-hide="newtransction">
                                {{pickTran.date | date:settings.formatdate}}
                            </span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a ng-click="pickOddOption('New Transaction')">New Transaction</a>
                            </li>
                            <li ng-repeat="i in dateoptions(changedTransactions);">
                                <a ng-click="pickmOption(i)">{{i.date | date:settings.formatdate}}</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <div class="pull-left standard-button gray">
            <button class="btn" ng-click="mclose(); mReset();">Undo</button>
        </div>
        <div class="standard-button green">
            <button class="btn" ng-click="mclose(); mComplete(changedTransactions, pickTran, changedNum, changedType);">Complete</button>
        </div>
    </div>
</div>

<div modal="issueModal" close="iclose();" options="opts">
    <div class="modalHeader">
        <span>Updating Issue?</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="iclose(); irevert(changedIssue);"></span>
    </div>
    <div class="modalText">
        <form>
            <p>There are transactions in this issue with different values.<br> Making this change will override them, are
                you sure you<br> want to continue?</p>
        </form>
    </div>
    <div class="modal-footer">
        <div class="pull-left standard-button gray">
            <button class="btn" ng-click="iclose(); irevert(changedIssue);">No</button>
        </div>
        <div class="standard-button green">
            <button class="btn" ng-click="iclose(); saveIssue(changedIssue, changedIssueField);">Yes</button>
        </div>
    </div>
</div>

<div modal="capDelete" close="dclose(); revertIssue(missue);" options="opts">
    <div class="modalHeader">
        <span>Delete?</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="dclose(); revertIssue(missue);"></span>
    </div>
    <div class="modalText">
        <form>
            <p>Do you want to delete this issue, including all associated transactions?</p>
            <br>
        </form>
    </div>
    <div class="modal-footer">
        <div class="pull-left standard-button gray">
            <button class="btn" ng-click="dclose(); revertIssue(missue);">No</button>
        </div>
        <div class="standard-button green">
            <button class="btn" ng-click="dclose(); deleteIssue(missue);">Yes</button>
        </div>
    </div>
</div>

<div modal="rowDelete" close="rclose(); revertPerson(minvestor);" options="opts">
    <div class="modalHeader">
        <span>Delete?</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="rclose(); revertPerson(minvestor);"></span>
    </div>
    <div class="modalText">
        <form>
            <p>Do you want to delete this shareholder, including all associated transactions?</p>
            <br>
        </form>
    </div>
    <div class="modal-footer">
        <div class="pull-left standard-button gray">
            <button class="btn" ng-click="rclose(); revertPerson(minvestor);">No</button>
        </div>
        <div class="standard-button green">
            <button class="btn" ng-click="rclose(); deletePerson(minvestor);">Yes</button>
        </div>
    </div>
</div>

<div modal="tranDelete" close="deleteclose();" options="opts">
    <div class="modalHeader">
        <span>Delete?</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="deleteclose(); revertTran(deleteTran);"></span>
    </div>
    <div class="modalText">
        <form>
            <p>Are you sure you want to delete this transaction?</p>
            <br>
        </form>
    </div>
    <div class="modal-footer">
        <div class="pull-left standard-button gray">
            <button class="btn" ng-click="deleteclose(); revertTran(deleteTran);">No</button>
        </div>
        <div class="standard-button green">
            <button class="btn" ng-click="deleteclose(); manualdeleteTran(deleteTran);">Yes</button>
        </div>
    </div>
</div>

<div modal="convertModal" close="convertSharesClose();" options="convertopts">
    <div class="modalHeader">
        <span>Convert Shares</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="convertSharesClose()"></span>
    </div>
    <div ng-show="convertTran.step == '1'" class="modalText convert-step-one">
        <div>
            <span>Transaction</span>
            <ul class="dropdown-list drop-selector">
                <li class="dropdown standard">
                    <a class="dropdown-toggle">
                        {{convertTran.tran.date | date:settings.shortdate}}<span class="invisible-drop">'</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li ng-repeat="i in convertTransOptions">
                            <span ng-click="assignConvertFrom(i);">{{i.date | date:settings.shortdate}}</span>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="pull-right">
            <span>Convert To</span>
            <ul class="dropdown-list drop-selector">
                <li class="dropdown standard">
                    <a class="dropdown-toggle">
                        {{convertTran.toissue.issue | maxLength}}<span class="invisible-drop">'</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li ng-repeat="i in justEquity(issues, convertTransOptions[0])">
                            <span ng-click="assignConvert('toissue', i);">{{i.issue | maxLength}}</span>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <div ng-show="convertTran.toissue.issue">
            <span>Date</span>
            <input id="converttrandate" ng-change="dateConvert()" ui-event="{keydown:'dateConvert($event)', blur:'dateConvert(\'blur\')'}" type="text"
                   ng-model="convertTran.date" data-date-format={{settings.lowercasedate}} bs-datepicker
                   onkeydown="testForEnter();">
        </div>
        <div ng-show="convertTran.toissue.issue" class="pull-right">
            <span>Method</span>
            <ul class="dropdown-list drop-selector">
                <li class="dropdown standard">
                    <a class="dropdown-toggle">
                        {{convertTran.method}}<span class="invisible-drop">'</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <span ng-show="convertTran.toissue.ppshare" ng-click="assignConvert('method', 'Valuation')">Valuation</span>
                            <span ng-click="assignConvert('method', 'Price Per Share')">Price Per Share</span>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <div ng-show="convertTran.method == 'Price Per Share'" class="pull-right">
            <span class="double">Conversion PPS</span>
            <input type="text" ng-model="convertTran.ppshare" onkeydown="testForEnter();">
        </div>
    </div>
    <div ng-show="convertTran.step == '2'" class="modalText">
        <div class="convert-listing">
            <span>From</span>
            <ul>
                <li>{{convertTran.tran.issue}}</li>
                <li>Security</li>
                <li ng-show="convertTran.tran.discount && convertTran.method != 'Price Per Share'">
                    <span ng-hide="convertTran.newtran.valcappercentage">{{convertTran.tran.discount}}%</span>
                    <span ng-show="convertTran.newtran.valcappercentage">{{convertTran.newtran.valcappercentage}}% (w/ valuation cap)</span>
                </li>
                <li ng-show="convertTran.tran.discount && convertTran.method != 'Price Per Share'">Percent Discount</li>
                <li ng-show="convertTran.newtran.valcappercentage && convertTran.tran.valcap && convertTran.method != 'Price Per Share'">{{formatDollarAmount(convertTran.tran.valcap)}}</li>
                <li ng-show="convertTran.newtran.valcappercentage && convertTran.tran.valcap && convertTran.method != 'Price Per Share'">Valuation Cap</li>
            </ul>
        </div>
        <div class="convert-listing">
            <span>To</span>
            <ul>
                <li>{{convertTran.toissue.issue}}</li>
                <li>Security</li>
                <li ng-show="convertTran.toissue.premoney">{{formatDollarAmount(convertTran.toissue.premoney)}}</li>
                <li ng-show="convertTran.toissue.premoney">Pre-Money Valuation</li>
                <li ng-show="convertTran.toissue.ppshare">{{formatDollarAmount(convertTran.toissue.ppshare)}}</li>
                <li ng-show="convertTran.toissue.ppshare">Security PPS</li>
            </ul>
        </div>
        <div class="convert-summary">
            <span>Summary</span>
            <ul>
                <li><span>{{convertTran.date | date:settings.shortdate}}</span><span>Date</span></li>
                <li><span>{{formatDollarAmount(convertTran.newtran.amount)}}</span><span>Debt + Interest</span></li>
                <li><span>{{formatDollarAmount(convertTran.newtran.ppshare)}}</span><span>Effective PPS</span></li>
                <li><span>{{formatAmount(convertTran.newtran.units)}}</span><span>Resulting Shares</span></li>
            </ul>
        </div>
    </div>
    <div class="modal-footer">
        <div ng-show="convertTran.step == '1'" class="pull-left standard-button gray">
            <button class="btn" ng-click="convertSharesClose();">Cancel</button>
        </div>
        <div ng-show="convertTran.step == '1'" class="pull-right standard-button blue arrow-right">
            <button class="btn" ng-disabled="!convertTran.tran.issue || !convertTran.toissue.issue || !convertTran.method || !convertTran.date" ng-click="convertgoto('2');">Review</button>
        </div>
        <div ng-show="convertTran.step == '2'" class="pull-left standard-button blue">
            <button class="btn" ng-click="convertgoto('1');">Back</button>
        </div>
        <div ng-show="convertTran.step == '2'" class="pull-right standard-button">
            <button class="btn" ng-click="performConvert(convertTran); convertSharesClose();">Submit</button>
        </div>
        <div ng-show="convertTran.step == '2'" class="pull-right standard-button small-standard-button gray cancel-convert">
            <button class="btn" ng-click="convertSharesClose();">Cancel</button>
        </div>
    </div>
</div>

<div modal="splitModal" close="splitSharesClose();" options="convertopts">
    <div class="modalHeader">
        <span>Split Shares</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="splitSharesClose()"></span>
    </div>
    <div class="modalText splitting">
        <div class="convert-listing">
            <span>From</span>
            <ul>
                <li>{{splitIssue.issue}}</li>
                <li>Security</li>
            </ul>
        </div>
        <div class="split-input">
            <div>
                <span>Date</span>
                <input id="splitissuedate" ng-change="dateSplit()" ui-event="{keydown:'dateSplit($event)', blur:'dateSplit(\'blur\')'}" type="text"
                       ng-model="splitIssue.date" data-date-format={{settings.lowercasedate}} bs-datepicker
                       onkeydown="testForEnter();">
            </div>
            <div class="ratio-input">
                <span>Ratio</span>
                <input type="text" ng-model="splitIssue.ratioa" onkeydown="testForEnter();">
                <span>:</span>
                <input type="text" ng-model="splitIssue.ratiob" onkeydown="testForEnter();">
            </div>
        </div>
        <div class="convert-summary three">
            <span>Summary</span>
            <ul>
                <li>
                    <span>
                        <span ng-show="totalinissue(splitIssue)">{{formatAmount(totalinissue(splitIssue))}}</span>
                        <span ng-hide="totalinissue(splitIssue)">No Shares</span>
                    </span>
                    <span>Pre-split shares</span>
                </li>
                <li>
                    <span>
                        <span ng-show="splitvalue(splitIssue)">{{formatAmount(splitvalue(splitIssue))}}</span>
                        <span ng-hide="splitvalue(splitIssue)">Invalid Ratio</span>
                    </span>
                    <span>Post-split shares</span>
                </li>
                <li>
                    <span>
                        <span ng-show="splitppshare(splitIssue)">{{formatDollarAmount(splitppshare(splitIssue))}}</span>
                        <span ng-hide="splitppshare(splitIssue)">
                            <span ng-show="splitvalue(splitIssue)">Share Price Not Set</span>
                            <span ng-hide="splitvalue(splitIssue)">Invalid Ratio</span>
                        </span>
                    </span>
                    <span>new price per share</span>
                </li>
            </ul>
        </div>
    </div>
    <div class="modal-footer">
        <div class="pull-right standard-button">
            <button ng-disabled="!splitvalue(splitIssue) || splitvalue(splitIssue) == 'Infinity'" class="btn" ng-click="performSplit(splitIssue); splitSharesClose();">Submit</button>
        </div>
        <div class="pull-left standard-button small-standard-button gray">
            <button class="btn" ng-click="splitSharesClose();">Cancel</button>
        </div>
    </div>
</div>

<div modal="transferModal" close="transferSharesClose();" options="transferopts">
    <div class="modalHeader">
        <span>Transfer Shares</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="transferSharesClose()"></span>
    </div>
    <div class="modalText">
        <div class="convert-listing solo">
            <span>From</span>
            <ul>
                <li>{{transfer.trans[0].investor}}</li>
                <li>Shareholder</li>
            </ul>
        </div>
        <div class="transfer-date-field">
            <span>Date</span>
            <input id="transferdate" ng-change="dateTransfer()" ui-event="{keydown:'dateTransfer($event)', blur:'dateTransfer(\'blur\')'}" type="text"
                   ng-model="transfer.date" data-date-format={{settings.lowercasedate}} bs-datepicker
                   onkeydown="testForEnter();">
        </div>

        <div class="docLibrary full-width">
            <table class="captable tableView modal-table">
                <tr class="column-label">
                    <th>Transaction</th>
                    <th>Existing Shares</th>
                    <th>Shares to Transfer</th>
                    <th>Recipient</th>
                </tr>
                <tr ng-repeat="tran in transfer.trans">
                    <td>{{tran.date | date:settings.shortdate}}</td>
                    <td>{{formatAmount(tran.units)}}</td>
                    <td><input class="transfer-shares-input" type="text" ng-model="tran.transferunits" onkeydown="testForEnter();"></td>
                    <td>
                        <ul class="dropdown-list drop-selector">
                            <li class="dropdown standard">
                                <a class="dropdown-toggle">
                                    {{tran.transferto}}<span class="invisible-drop">'</span>
                                </a>
                                <ul class="dropdown-menu">
                                    <li ng-repeat="row in rows | otherinvestors: tran.investor">
                                        <span ng-click="trantorow(tran, row.namekey)">{{row.namekey}}</span>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="modal-footer">
        <div class="pull-right standard-button">
            <button class="btn" ng-click="performTransfer(); transferSharesClose();">Submit</button>
        </div>
        <div class="pull-left standard-button small-standard-button gray">
            <button class="btn" ng-click="transferSharesClose();">Cancel</button>
        </div>
    </div>
</div>

<div modal="capAccess" close="accessclose()" options="shareopts">
    <div class="modalHeader">
        <span>Change Permissions</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="accessclose()"></span>
    </div>
    <div class="modalText">
        <form class="capaccess-form">
            <p>Shareholders only see their personal holdings by default,<br> non-shareholders will see the full table unless revoked.</p>
            <div class="cf capaccess-drop">
                <span>CURRENT</span>
                <li class="dropdown standard pull-left">

                    <ul class="dropdown-list drop-selector">
                        <li class="dropdown standard">
                            <a class="dropdown-toggle">
                                {{selectedI.level}}<span class="invisible-drop">'</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li>
                                    <span ng-click="selectVisibility('No View', selectedI)">No View</span>
                                    <span ng-click="selectVisibility('Personal View', selectedI)">Personal View</span>
                                    <span ng-click="selectVisibility('Full View', selectedI)">Full View</span>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <div class="pull-left standard-button gray">
            <button class="btn" ng-click="accessclose()">Cancel</button>
        </div>
        <div class="standard-button green">
            <button class="btn" ng-click="changeVisibility(selectedI); accessclose();">Change</button>
        </div>
    </div>
</div>

<!-- Tour Modal -->
<div modal="tourModal" close="tourclose();" options="touropts">
    <div class="modalHeader">
        <span>Welcome to your cap table!</span>
        <span class="close" data-icon="&#xe00f;" aria-hidden="true" ng-click="tourclose();"></span>
    </div>
    <div class="modalText">
        <div class="row-fluid">
            <div class="span6">
                <p>We've created a simple tour to introduce you to your cap table, and guide you through the basics.</p>
            </div>
            <div class="span6">
                <span class="tour-icon intro-icon"><span>?</span></span>
                <div class="tooltip fade top in" style="top: 61px; left: 315px; width: 150px;display: block;"><div class="tooltip-arrow"></div><div class="tooltip-inner">{{tourmessages.intro}}</div></div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div class="pull-left standard-button green">
            <button id='a_own_tour_start_modal' class="btn" ng-click="tourclose(); moveTour(); kissTour();">Start the Tour</button>
        </div>
        <div class="pull-left text-button">
            <button ng-click="tourclose();">I'm a pro, skip the tour</button>
        </div>
    </div>
</div>


<!-- Captable From Here Down -->
<subnav>
    <div class="box-button pull-right"
         ng-if="!windowToggle"
         ng-class="{'disabledme': companyIsZombie()}"
         ng-click="companyIsZombie() || modalUp();"
         id='a_own_tour_share_subnav'
         data-placement="bottom" bs-tooltip="zombiemessage">
        <span ng-hide="toggleView() || tourstate == 0" class="tour-icon tour-share" data-placement="bottom" bs-tooltip="tourmessages.share"><span>?</span></span>
        <ul>
            <li> <span data-icon="&#xe604;" aria-hidden="true"></span>

            </li>
            <li> <span>Share</span>

            </li>
        </ul>
    </div>

    <div class="box-button pull-right"
         ng-if="!windowToggle"
         ng-class="{'disabledme': companyIsZombie()}"
         ng-click="companyIsZombie() || editViewToggle();"
         data-placement="bottom" bs-tooltip="zombiemessage">
        <span ng-hide="toggleView() || tourstate == 0" class="tour-icon tour-view"  data-placement="bottom" bs-tooltip="tourmessages.view"><span>?</span></span>
        <ul>
            <li> <span ng-show="!toggleView()" data-icon="&#xe001;" aria-hidden="true"></span>
                 <span ng-show="toggleView()" data-icon="&#xe00e;" aria-hidden="true"></span>
            </li>
            <li> <span>{{radioModel}}</span>

            </li>
        </ul>
    </div>

    <div class="evidenceSearch" ng-if="windowToggle">
        <span>Search</span>
        <input type="text" class="search-box" ng-model="state.evidenceQuery">
    </div>
</subnav>

<div class="row-fluid leftTabWindow" ng-class="{showRightTab:windowToggle}">
<div ng-style="viewportheight" ng-class="{leftFullTableBlock:sideToggle, widthtransition25:oldSafari()}" class="span8 docLibrary leftBlock">

    <div class="row-fluid capcontainer">
        <table ng-class="{viewcaptable:toggleView()}" class="captable tableView bodyText">
            <!-- Editable headers -->
            <tr ng-if="!toggleView();" class="column-label">
                <th class="longrow" colspan="2">
                    Ownership
                </th>
                <th class="longrow">Shareholder</th>
                <th ng-repeat="one in issues track by $index">
                    <span ng-class="{'column-highlight':tourstate==2}"><span class="next-button" ng-click="moveTour();">Next</span></span>
                    <input placeholder="Add Security" class="capEditHeaders"
                           ui-event="{focus : 'getActiveIssue(one.issue)', blur : 'saveIssue(one, \'issue\')'}" ng-model="one.issue"
                           onkeydown="testForEnter();">
                </th>
            </tr>
            <!-- Uneditable headers -->
            <tr ng-if="toggleView();" class="column-label">
                <th class="longrow" colspan="2">Ownership</th>
                <th class="longrow">Shareholder</th>
                <th ng-class="{tranViewSelected:one.state}" class="staticHeaders" ng-repeat="one in issues | issueviewList track by $index" ng-click="getActiveIssue(one.issue)">
                    <span>{{one.issue}}</span>
                    <span class="next-button" ng-click="moveTour();">Next</span>
                </th>
            </tr>

            <!-- Descriptive row viewable from all modes -->
            <tr class="descriptionRow" ng-class="{'viewmode':toggleView()}">
                <td class="input-right">Shares</td>
                <td class="input-right">%</td>
                <td></td>
                <td ng-repeat="one in issuekeys | orderBy:issueSort track by $index">
                    <span>{{grantbyIssue(one)}}</span>
                    <span>Total Paid</span>
                </td>
            </tr>
            <!-- Editable rows -->
            <tr ng-if="!toggleView();" ng-repeat="row in rows track by $index" ng-show="([row] | noUnissue).length > 0">
                <td class="capsums-col"><input class="input-right" disabled value="{{shareSum(row) || 0}}"></td>
                <td class="capsums-col"><input class="input-right" disabled value="{{sharePercentage(row, rows, issuekeys) || 0.000 | number:3}}%">
                </td>
                <td>
                    <span ng-class="{'box-highlight':tourstate==1}"><span class="next-button" ng-click="moveTour();">Next</span></span>
                      <span ng-switch on="row.nameeditable">
                        <span ng-switch-default>
                          <input class="name-row" placeholder="Add Name" style="width:140px;"
                                 ng-model="row.name"
                                 ng-change="nameChangeLR(row)"
                                 ui-event="{focus : 'getActiveInvestor(row)', blur : 'updateRow(row)'}"
                                 onpaste="return false"
                                 ng-paste="namePaste($event, row);"
                                 onkeydown="testForEnter();">
                        </span>
                        <span ng-switch-when="0">
                          <input class="name-row" disabled style="width:180px;" ng-model="row.name">
                        </span>
                      </span>
                </td>
                <td ng-repeat="key in issuekeys | orderBy:issueSort track by $index">
                    <span ng-class="{'tran-highlight':tourstate==4}"><span class="next-button" ng-click="closeTour(); tourNotification();">Done!</span></span>
                      <span ng-switch on="row.editable">
                        <span ng-class="{tranSelected:row[key].state}" class="captablepair-box" ng-switch-default>
                          <input ng-show="isDebt(key);" class="captablepair first-box" maxlength="18"
                                 placeholder="{{grantbyIssue(key)}}"
                                 ui-event="{focus : 'getActiveTransaction(row.name, key)', blur : 'saveTran(activeTran)'}"
                                 ng-change="tranChangeU(row[key]['u'], key)" ng-model='row[key]["u"]'
                                 onpaste="return false"
                                 ng-paste="numberPaste($event, row, key, 'u');"
                                 onkeydown="testForEnter();">
                          <input ng-hide="isDebt(key);" class="captablepair default-pointer first-box" disabled>
                          <input class="captablepair last-box" maxlength="18" placeholder="paid"
                                 ui-event="{focus : 'getActiveTransaction(row.name, key)', blur : 'saveTran(activeTran)'}"
                                 ng-change="tranChangeA(row[key]['a'])" ng-model='row[key]["a"]'
                                 onpaste="return false"
                                 ng-paste="numberPaste($event, row, key, 'a');"
                                 onkeydown="testForEnter();">
                        </span>
                        <span class="captablepair-box" ng-switch-when="0">
                          <input disabled class="captablepair" placeholder="shares"
                                 ng-model='row[key]["u"]'
                                 onkeydown="testForEnter();">
                          <input disabled class="captablepair" placeholder="paid"
                                 ng-model='row[key]["a"]'
                                 onkeydown="testForEnter();">
                        </span>
                      </span>
                </td>
            </tr>
            <!-- Un-editable view -->
            <!-- Regular Rows -->
            <tr ng-if="toggleView()" ng-repeat="row in rows | rowviewList track by $index">
                <td class="capsums-col"><input class="input-right" disabled value="{{shareSum(row);}}"></td>
                <td class="capsums-col"><input class="input-right" disabled value="{{sharePercentage(row, rows, issuekeys) | number:3}}%"></td>
                <td ng-class="{tranViewSelected:row.state, 'hoverable': row.name}" class="viewName tableFields" ng-click="getActiveInvestor(row);">{{row.name}}</td>
                <td ng-click="getActiveTransaction(row.name, key)" class="tableFields" ng-class="{tranViewSelected:row[key].state, 'hoverable':canHover(row[key])}" ng-repeat="key in issuekeys | orderBy:issueSort track by $index">
                            <span class="captablepair-box">
                                <div ng-bind="formatAmount(row[key]['u'])" class="output clickable"></div>
                                <div ng-bind="formatDollarAmount(row[key]['a'])" class="output second clickable"></div>
                            </span>
                </td>
            </tr>
            <!-- Unissued Rows -->
            <tr class="unissued-rows" ng-repeat="row in rows track by $index" ng-show="([row] | unissuedrowviewList).length > 0">
                <td class="capsums-col"><input class="input-right" disabled value="{{shareSum(row);}}"></td>
                <td class="capsums-col"><input class="input-right" disabled value="{{sharePercentage(row, rows, issuekeys) | number:3}}%"></td>
                <td  class="viewName">{{row.name}}</td>
                <td class="tableFields" ng-repeat="key in issuekeys | orderBy:issueSort track by $index">
                            <span class="captablepair-box">
                                <div ng-class="{'editview': !toggleView()}" ng-bind="formatAmount(row[key]['u'])" class="output clickable"></div>
                                <div ng-class="{'editview': !toggleView()}" ng-bind="formatDollarAmount(row[key]['a'])" class="output second clickable"></div>
                            </span>
                </td>
            </tr>
            <!-- Footer Total Row -->
            <tr class="total-row">
                <td class="tableFields">Total</td>
                <td class="tableFields"></td>
                <td class="tableFields"></td>
                <td class="tableFields" ng-repeat="one in issuekeys track by $index"></td>
            </tr>
            <!-- Undiluted footer -->
            <tr class='tablefooter'>
                <td class="capsums-col"><input class="input-right" disabled value="{{totalShares(rows);}}"></td>
                <td class="capsums-col"><input class="input-right" disabled value="100.00%"></td>
                <td class="tableFields"></td>
                <td class="tableFields" ng-repeat="one in issuekeys track by $index">
                            <span class="captablepair-box">
                                <div ng-bind="formatAmount(colTotal(one, rows, 'u'))" ng-class="{'editview': !toggleView()}" class="output footer"></div>

                                <div ng-bind="formatDollarAmount(colTotal(one, rows, 'a'))" ng-class="{'editview': !toggleView()}" class="output second footer"></div>
                            </span>
                </td>
            </tr>
        </table>
    </div>
</div>

<internal-right-rail toggle-side="sideToggle" window-toggle="windowToggle" window-callback="editEvidence()">
    <tabset ng-class="{'singletab': tabnumber() == 1, 'tabBorder': windowToggle}">
        <tab ng-repeat="tab in tabs" active="tab.active" ng-if="tabvisible(tab)" heading="{{tab.title}}">
                <div ng-show="chosenTab(tab, 'Information')" ng-style="viewportactivity" ng-switch on="sideBar">
<!-- Issues Side Bar when Editable -->
                    <span ng-switch-when="1">

                        <!-- Global Tab -->
                        <div class="capGuide global"  ng-class="{'issue-rail':tourstate==3}">
                            <span class="next-button" ng-click="moveTour();">Next</span>

                            <div class="rightTitle security-type">
                                <span>Security name</span>
                                <input ng-disabled="toggleView();" ui-event="{blur : 'saveIssue(activeIssue, \'issue\')'}"
                                                                                   ng-model="activeIssue.issue"
                                                                                   onkeydown="testForEnter();">
                                <div ng-click="splitSharesUp(activeIssue);" ng-show="activeIssue.type == 'Equity' || activeIssue.type == 'Option'">
                                    <span data-icon="&#xe60b;" aria-hidden="true"></span>
                                    <span>Split</span>
                                </div>
                            </div>

                            <p class="rightTitle security-type"><span>Security Date</span><input ng-disabled="toggleView();" id="date{{activeIssue.$$hashKey}}" ng-change="saveIssueCheckDate(activeIssue, 'date')" ui-event="{keydown:'saveIssueCheckDate(activeIssue, \'date\', $event)', blur:'saveIssueCheckDate(activeIssue, \'date\', \'blur\')'}" type="text"
                                                                                ng-model="activeIssue.date" data-date-format={{settings.lowercasedate}} bs-datepicker
                                                                                onkeydown="testForEnter();"></p>

                            <div class="rightTitle security-type"><span>Security Type</span>
                                    <span ng-show="typeLocked(activeIssue);">
                                        <ul class="dropdown-list drop-selector">
                                            <li class="dropdown standard">
                                                <a class="dropdown-toggle">
                                                    {{activeIssue.type}}<span class="invisible-drop">'</span>
                                                </a>
                                                <ul ng-hide="toggleView();" class="dropdown-menu">
                                                    <li ng-repeat="i in issuetypes track by $index">
                                                        <a ng-click="saveIssueAssign(activeIssue, 'type', i)">{{i}}</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </span>
                                    <span class="locked-security" ng-hide="typeLocked(activeIssue);">
                                        {{activeIssue.type}}
                                    </span>
                                    <span ng-show="trantype(activeIssue.type, 'Equity');" class="common-toggle">
                                        <button ng-class="{'selected':activeIssue.common}" ng-click="toggleCommon(activeIssue)" ng-model="activeIssue.common" class="check-box-button"><span data-icon="&#xe023;" aria-hidden="true"></span></button><span>Common</span>
                                    </span>
                            </div>
                        </div>
                        <!-- Equity Tab -->
                        <div class="capGuide top10" ng-show="trantype(activeIssue.type, 'Equity');">

                            <p class="rightTitle double"><span>Pre-Money Valuation</span><input ng-disabled="toggleView();"
                                                                                                pattern="[0-9]*(.[0-9]*)*"
                                                                                                ui-event="{blur : 'saveIssue(activeIssue, \'premoney\')'}"
                                                                                                ng-model="activeIssue.premoney"
                                                                                                onkeydown="testForEnter();">

                                <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.premoneyval"></span>
                            </p>

                            <p class="rightTitle double"><span>Post-Money Valuation</span><input ng-disabled="toggleView();"
                                                                                                 ui-event="{blur : 'saveIssue(activeIssue, \'postmoney\')'}"
                                                                                                 ng-model="activeIssue.postmoney"
                                                                                                 onkeydown="testForEnter();">

                                <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.postmoneyval"></span>
                            </p>

                            <p class="rightTitle"><span>Share Price</span><input ng-disabled="toggleView();"
                                                                                 ui-event="{blur : 'saveIssueCheck(activeIssue, \'ppshare\')'}"
                                                                                 ng-model="activeIssue.ppshare"
                                                                                 onkeydown="testForEnter();">

                                <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.ppshare"></span>
                            </p>

                            <p class="rightTitle"><span>Total Authorized</span><input ng-disabled="toggleView();"
                                                                                      ui-event="{blur : 'saveIssue(activeIssue, \'totalauth\')'}"
                                                                                      ng-model="activeIssue.totalauth"
                                                                                      onkeydown="testForEnter();">

                                <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.totalauth"></span>
                            </p>

                            <div ng-hide="activeIssue.common" class="rightTitle double"><span>Liquidation Preference</span>
                                <ul class="dropdown-list drop-selector">
                                    <li class="dropdown standard">
                                        <a class="dropdown-toggle">
                                            {{activeIssue.liquidpref}}<span class="invisible-drop">'</span>
                                        </a>
                                        <ul ng-hide="toggleView();" class="dropdown-menu">
                                            <li ng-repeat="i in liquidpref track by $index">
                                                <a ng-click="saveIssueAssign(activeIssue, 'liquidpref', i)">{{i}}</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.liquidpref"></span>
                            </div>

                            <div ng-hide="activeIssue.common" class="rightTitle double"><span>Participating Preferred</span>
                                <ul class="dropdown-list drop-selector">
                                    <li class="dropdown standard">
                                        <a class="dropdown-toggle">
                                            {{activeIssue.partpref | falseCheck}}<span class="invisible-drop">'</span>
                                        </a>
                                        <ul ng-hide="toggleView();" class="dropdown-menu">
                                            <li ng-repeat="i in tf track by $index">
                                                <a ng-click="saveIssueAssign(activeIssue, 'partpref', i)">{{i}}</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.partpref"></span>
                            </div>


                            <div ng-hide="activeIssue.common" class="rightTitle"><span>Drag Along</span>
                                <ul class="dropdown-list drop-selector">
                                    <li class="dropdown standard">
                                        <a class="dropdown-toggle">
                                            {{activeIssue.dragalong | falseCheck}}<span class="invisible-drop">'</span>
                                        </a>
                                        <ul ng-hide="toggleView();" class="dropdown-menu">
                                            <li ng-repeat="i in tf track by $index">
                                                <a ng-click="saveIssueAssign(activeIssue, 'dragalong', i)">{{i}}</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.dragalong"></span>
                            </div>

                            <div ng-hide="activeIssue.common" class="rightTitle"><span>Tag Along</span>
                                <ul class="dropdown-list drop-selector">
                                    <li class="dropdown standard">
                                        <a class="dropdown-toggle">
                                            {{activeIssue.tagalong | falseCheck}}<span class="invisible-drop">'</span>
                                        </a>
                                        <ul ng-hide="toggleView();" class="dropdown-menu">
                                            <li ng-repeat="i in tf track by $index">
                                                <a ng-click="saveIssueAssign(activeIssue, 'tagalong', i)">{{i}}</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.tagalong"></span>
                            </div>

                            <span ng-show="showPari(allowKeys) && !activeIssue.common" class="paripassu-list">
                                <div class="rightTitle" ng-repeat="item in activeIssue.paripassu track by $index"><span>Pari Passu With</span>
                                    <ul class="dropdown-list drop-selector">
                                        <li class="dropdown standard">
                                            <a class="dropdown-toggle">
                                                {{item.pariwith | maxLength}}<span class="invisible-drop">'</span>
                                            </a>
                                            <ul ng-hide="toggleView();" class="dropdown-menu">
                                                <li ng-repeat="i in availableKeys(allowKeys, activeIssue.paripassu) track by $index">
                                                    <a ng-click="saveIssuePari(i, item, activeIssue.paripassu)">{{i | maxLength}}</a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                    <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.paripassu"></span>
                                    <button class="icon-button" ng-click="addIssuePari(activeIssue.paripassu)"><span data-icon="&#xe053;" aria-hidden="true"></span></button>
                                </div>
                            </span>

                        </div>
                          <!-- Options Tab -->
                          <div class="capGuide top10" ng-show="trantype(activeIssue.type, 'Option');">
                              <div class="rightTitle double"><span>Underlying Security</span>
                                  <ul class="dropdown-list drop-selector">
                                      <li class="dropdown standard">
                                          <a class="dropdown-toggle">
                                              {{activeIssue.optundersec | maxLength}}<span class="invisible-drop">'</span>
                                          </a>
                                          <ul ng-hide="toggleView();" class="dropdown-menu">
                                              <li ng-repeat="i in allowKeys track by $index">
                                                  <a ng-click="saveIssueAssign(activeIssue, 'optundersec', i)">{{i  | maxLength}}</a>
                                              </li>
                                          </ul>
                                      </li>
                                  </ul>
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.optundersec"></span>
                              </div>

                              <p class="rightTitle"><span>Total Authorized</span><input ng-disabled="toggleView();"
                                                                                        ui-event="{blur : 'saveIssue(activeIssue, \'totalauth\')'}"
                                                                                        ng-model="activeIssue.totalauth"
                                                                                        onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.totalauth"></span>
                              </p>

                              <p class="rightTitle"><span>Total Granted</span><input disabled value="{{totalGranted(activeIssue.issue, trans);}}">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.totalgranted"></span>
                              </p>

                              <p class="rightTitle"><span>Strike Price</span><input ng-disabled="toggleView();"
                                                                                    ui-event="{blur : 'saveIssueCheck(activeIssue, \'price\')'}"
                                                                                    ng-model="activeIssue.price"
                                                                                    onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.price"></span>
                              </p>

                              <p class="rightTitle double"><span>Vesting Term (months)</span><input ng-disabled="toggleView();"
                                                                                                    ui-event="{blur : 'saveIssueCheck(activeIssue, \'terms\')'}"
                                                                                                    ng-model="activeIssue.terms"
                                                                                                    onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.terms"></span>
                              </p>

                              <p class="rightTitle double"><span>Vesting Cliff (Months)</span><input type="text" ng-model="activeIssue.vestingbeginsdisplay"
                                                                                                     ui-event="{blur : 'saveIssueCheck(activeIssue, \'vestingbegins\')'}"
                                                                                                     onkeydown="testForEnter();">

                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.vestingbegins"></span>
                              </p>

                              <p class="rightTitle"><span>Vesting Cliff %</span><input ng-disabled="toggleView();"
                                                                                       ui-event="{blur : 'saveIssueCheck(activeIssue, \'vestcliff\')'}"
                                                                                       ng-model="activeIssue.vestcliff"
                                                                                       onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.vestcliff"></span>
                              </p>

                              <div class="rightTitle double"><span>Post Cliff Frequency</span>
                                  <ul class="dropdown-list drop-selector">
                                      <li class="dropdown standard">
                                          <a class="dropdown-toggle">
                                              {{activeIssue.vestfreq}}<span class="invisible-drop">'</span>
                                          </a>
                                          <ul ng-hide="toggleView();" class="dropdown-menu">
                                              <li ng-repeat="i in freqtypes track by $index">
                                                  <a ng-click="saveIssueAssign(activeIssue, 'vestfreq', i)">{{i}}</a>
                                              </li>
                                          </ul>
                                      </li>
                                  </ul>
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.vestfreq"></span>
                              </div>
                          </div>

                          <!-- Debt tab -->
                          <div class="capGuide top10" ng-show="trantype(activeIssue.type, 'Debt');">

                              <p class="rightTitle double"><span>Pre-Money Valuation</span><input ng-disabled="toggleView();"
                                                                                                  pattern="[0-9]*(.[0-9]*)*"
                                                                                                  ui-event="{blur : 'saveIssue(activeIssue, \'premoney\')'}"
                                                                                                  ng-model="activeIssue.premoney"
                                                                                                  onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.premoneyval"></span>
                              </p>

                              <p class="rightTitle double"><span>Post-Money Valuation</span><input ng-disabled="toggleView();"
                                                                                                   ui-event="{blur : 'saveIssue(activeIssue, \'postmoney\')'}"
                                                                                                   ng-model="activeIssue.postmoney"
                                                                                                   onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.postmoneyval"></span>
                              </p>

                              <div class="rightTitle interest-rate">
                                  <span>Interest Rate</span>
                                  <input ng-disabled="toggleView();"
                                                                   ui-event="{blur : 'saveIssueCheck(activeIssue, \'interestrate\')'}"
                                                                   ng-model="activeIssue.interestrate"
                                                                   onkeydown="testForEnter();">

                                  <ul class="dropdown-list drop-selector">
                                      <li class="dropdown standard">
                                          <a class="dropdown-toggle">
                                              {{activeIssue.interestratefreq}}<span class="invisible-drop">'</span>
                                          </a>
                                          <ul class="dropdown-menu">
                                              <li ng-repeat="i in freqtypes track by $index">
                                                  <a ng-click="saveIssueAssign(activeIssue, 'interestratefreq', i)">{{i}}</a>
                                              </li>
                                          </ul>
                                      </li>
                                  </ul>
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.interestrate"></span>
                              </div>

                              <p style="display: inline-block" class="rightTitle"><span>Valuation Cap</span><input ng-disabled="toggleView();"
                                                                                                                   ui-event="{blur : 'saveIssueCheck(activeIssue, \'valcap\')'}"
                                                                                                                   ng-model="activeIssue.valcap"
                                                                                                                   onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.valcap"></span>
                              </p>

                              <p class="rightTitle"><span>Percent Discount</span><input ng-disabled="toggleView();"
                                                                                        ui-event="{blur : 'saveIssueCheck(activeIssue, \'discount\')'}"
                                                                                        ng-model="activeIssue.discount"
                                                                                        onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.discount"></span>
                              </p>

                              <p class="rightTitle"><span>Term (months)</span><input ng-disabled="toggleView();"
                                                                                     ui-event="{blur : 'saveIssueCheck(activeIssue, \'term\')'}"
                                                                                     ng-model="activeIssue.term"
                                                                                     onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.term"></span>
                              </p>

                          </div>

                        <!-- Safe tab -->
                          <div class="capGuide top10" ng-show="trantype(activeIssue.type, 'Safe');">

                              <p style="display: inline-block" class="rightTitle"><span>Valuation Cap</span><input ng-disabled="toggleView();"
                                                                                                                   ui-event="{blur : 'saveIssueCheck(activeIssue, \'valcap\')'}"
                                                                                                                   ng-model="activeIssue.valcap"
                                                                                                                   onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.valcap"></span>
                              </p>

                              <p class="rightTitle"><span>Percent Discount</span><input ng-disabled="toggleView();"
                                                                                        ui-event="{blur : 'saveIssueCheck(activeIssue, \'discount\')'}"
                                                                                        ng-model="activeIssue.discount"
                                                                                        onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.discount"></span>
                              </p>
                          </div>

                        <!-- Warrant tab -->
                          <div class="capGuide top10" ng-show="trantype(activeIssue.type, 'Warrant');">

                              <div class="rightTitle double"><span>Underlying Security</span>
                                  <ul class="dropdown-list drop-selector">
                                      <li class="dropdown standard">
                                          <a class="dropdown-toggle">
                                              {{activeIssue.optundersec | maxLength}}<span class="invisible-drop">'</span>
                                          </a>
                                          <ul ng-hide="toggleView();" class="dropdown-menu">
                                              <li ng-repeat="i in allowKeys track by $index">
                                                  <a ng-click="saveIssueAssign(activeIssue, 'optundersec', i)">{{i  | maxLength}}</a>
                                              </li>
                                          </ul>
                                      </li>
                                  </ul>
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.optundersec"></span>
                              </div>

                              <p class="rightTitle"><span>Strike Price</span><input ng-disabled="toggleView();"
                                                                                    ui-event="{blur : 'saveIssueCheck(activeIssue, \'price\')'}"
                                                                                    ng-model="activeIssue.price"
                                                                                    onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.pricewarrant"></span>
                              </p>

                              <p class="rightTitle"><span>Term (months)</span><input ng-disabled="toggleView();"
                                                                                     ui-event="{blur : 'saveIssueCheck(activeIssue, \'term\')'}"
                                                                                     ng-model="activeIssue.term"
                                                                                     onkeydown="testForEnter();">
                                  <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.termwarrant"></span>
                              </p>

                          </div>

                          <div><span class="blue-link delete-link" ng-click="deleteIssueButton(activeIssue);" data-icon="&#xe00c;">Delete security</span></div>
                      </span>

<!-- Transaction Side Bar when Editable -->
                      <span ng-switch-when="2">

                        <accordion ng-class="{'lessmargin': (activeTran.length == 1)}" class="transaction-accordion" close-others="true">
                        <accordion-group is-open="tran.active" is-disabled="singleTransaction(activeTran);" ng-hide="windowToggle && !tran.active"
                                         ng-repeat="tran in activeTran | orderBy:'date' track by $index" ng-switch on="currentTab">
                            <accordion-heading>
                                <span data-icon="&#xe031;" aria-hidden="true" ng-show="tran.active && activeTran.length > 1"></span>
                                <span data-icon="&#xe034;" aria-hidden="true" ng-show="!tran.active && activeTran.length > 1" ng-click="editEvidence()"></span>
                                <span ng-click="editEvidence()">{{tran.date | date:settings.shortdate}} Transaction</span>
                            </accordion-heading>

                            <div class="standard-button btn-group darkgray">
                                <button class="btn" ng-click="switchCapTab('details');" ng-class="{on:currentTab=='details'}">
                                    <span data-icon="&#xe01e;" aria-hidden="true">Details</span>
                                </button>
                                <button class="btn" ng-click="switchCapTab('documents');" ng-class="{on:currentTab=='documents'}">
                                    <span data-icon="&#xe60e;" aria-hidden="true">Evidence</span>
                                </button>
                            </div>

                            <div class="capTab" ng-switch-when="details">
                                <!-- Global Tab -->
                                <div class="capGuide global">

                                    <div class="rightTitle security-type">
                                        <span>Investor</span>
                                        <span class="locked-security">
                                            {{tran.investor}}
                                        </span>

                                        <div ng-click="transferSharesUp(activeTran);" ng-show="activeTran[0].type == 'Equity'">
                                            <span data-icon="&#xe60a;" aria-hidden="true"></span>
                                            <span>Transfer</span>
                                        </div>

                                        <div ng-click="convertSharesUp(activeTran);" ng-show="activeTran[0].type == 'Debt'">
                                            <span data-icon="&#xe60c;" aria-hidden="true"></span>
                                            <span>Convert</span>
                                        </div>
                                    </div>

                                    <p class="rightTitle"><span>Date</span><input ng-disabled="toggleView();" id="date{{tran.$$hashKey}}"
                                                                                  ui-event="{keydown:'saveTranDate(tran, \'date\', $event)', blur:'saveTranDate(tran, \'date\', \'blur\')'}"
                                                                                  ng-change="saveTranDate(tran, 'date')"
                                                                                  type="text" ng-model="tran.date" data-date-format={{settings.lowercasedate}} bs-datepicker>

                                    </p>

                                    <p class="rightTitle" ng-hide="tran.type =='Debt' || tran.type == 'Safe'"><span>{{grantbyIssue(tran.issue)}}</span><input ng-disabled="toggleView();"
                                                                                                                 maxlength="18" class="signless" ui-event="{blur : 'saveTran(tran)'}"
                                                                                                                 ng-model="tran.units" onkeydown="testForEnter();"></p>

                                    <p class="rightTitle"><span>Total Paid</span><input ng-disabled="toggleView();"
                                                                                        maxlength="18" ui-event="{blur : 'saveTran(tran)'}" ng-model="tran.amount" onkeydown="testForEnter();"></p>
                                </div>

                                <div class="capGuide top10">

                                    <p ng-show="tran.forfeited" class="rightTitle"><span>Forfeit</span><input disabled ng-class="{'content':!tran.units}" maxlength="18" class="signless"
                                                                                                              ui-event="{blur : 'saveTran(tran)'}" ng-model="tran.forfeited" onkeydown="testForEnter();"></p>

                                </div>

                                <!-- Equity Tab -->
                                <div class="capGuide top10" ng-show="trantype(tran.type, 'Equity');">

                                    <p class="rightTitle"><span>Share Price</span><input ng-disabled="toggleView();"
                                                                                         onkeydown="testForEnter();"
                                                                                         ui-event="{blur : 'saveTran(tran)'}"
                                                                                         ng-model="tran.ppshare">
                                    </p>


                                    <div ng-hide="commonstock(tran)" class="rightTitle double"><span>Liquidation Preference</span>
                                        <ul class="dropdown-list drop-selector">
                                            <li class="dropdown standard">
                                                <a class="dropdown-toggle">
                                                    {{tran.liquidpref}}<span class="invisible-drop">'</span>
                                                </a>
                                                <ul class="dropdown-menu">
                                                    <li ng-repeat="i in liquidpref track by $index">
                                                        <a ng-click="saveTranAssign(tran, 'liquidpref', i)">{{i}}</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.liquidpref"></span>
                                    </div>

                                    <div ng-hide="commonstock(tran)" class="rightTitle double"><span>Participating Preferred</span>
                                        <ul class="dropdown-list drop-selector">
                                            <li class="dropdown standard">
                                                <a class="dropdown-toggle">
                                                    {{tran.partpref  | falseCheck}}<span class="invisible-drop">'</span>
                                                </a>
                                                <ul class="dropdown-menu">
                                                    <li ng-repeat="i in tf">
                                                        <a ng-click="saveTranAssign(tran, 'partpref', i)">{{i}}</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.partpref"></span>
                                    </div>

                                    <div ng-hide="commonstock(tran)" class="rightTitle"><span>Drag Along</span>
                                        <ul class="dropdown-list drop-selector">
                                            <li class="dropdown standard">
                                                <a class="dropdown-toggle">
                                                    {{tran.dragalong  | falseCheck}}<span class="invisible-drop">'</span>
                                                </a>
                                                <ul class="dropdown-menu">
                                                    <li ng-repeat="i in tf">
                                                        <a ng-click="saveTranAssign(tran, 'dragalong', i)">{{i}}</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.dragalong"></span>
                                    </div>

                                    <div ng-hide="commonstock(tran)" class="rightTitle"><span>Tag Along</span>
                                        <ul class="dropdown-list drop-selector">
                                            <li class="dropdown standard">
                                                <a class="dropdown-toggle">
                                                    {{tran.tagalong  | falseCheck}}<span class="invisible-drop">'</span>
                                                </a>
                                                <ul class="dropdown-menu">
                                                    <li ng-repeat="i in tf track by $index">
                                                        <a ng-click="saveTranAssign(tran, 'tagalong', i)">{{i}}</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.tagalong"></span>
                                    </div>

                                </div>
                                <!-- Option Tab -->
                                <div class="capGuide top10" ng-show="trantype(tran.type, 'Option');">

                                    <p class="rightTitle"><span>Strike Price</span><input ng-disabled="toggleView();"
                                                                                          onkeydown="testForEnter();"
                                                                                          ui-event="{blur : 'saveTran(tran)'}"
                                                                                          ng-model="tran.price">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.price"></span>
                                    </p>

                                    <p class="rightTitle double"><span>Vesting Term (months)</span><input ng-disabled="toggleView();"
                                                                                                          onkeydown="testForEnter();"
                                                                                                          ui-event="{blur : 'saveTran(tran)'}"
                                                                                                          ng-model="tran.terms">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.terms"></span>
                                    </p>

                                    <p class="rightTitle double"><span>Vesting Cliff (months)</span><input type="text"
                                                                                                           onkeydown="testForEnter();"
                                                                                                           ui-event="{blur : 'saveTran(tran)'}"
                                                                                                           ng-model="tran.vestingbeginsdisplay">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.vestingbegins"></span>
                                    </p>

                                    <p class="rightTitle"><span>Vesting Cliff %</span><input ng-disabled="toggleView();"
                                                                                             onkeydown="testForEnter();"
                                                                                             ui-event="{blur : 'saveTran(tran)'}"
                                                                                             ng-model="tran.vestcliff">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.vestcliff"></span>
                                    </p>


                                    <div class="rightTitle double"><span>Post Cliff Frequency</span>
                                        <ul class="dropdown-list drop-selector">
                                            <li class="dropdown standard">
                                                <a class="dropdown-toggle">
                                                    {{tran.vestfreq}}<span class="invisible-drop">'</span>
                                                </a>
                                                <ul class="dropdown-menu">
                                                    <li ng-repeat="i in freqtypes track by $index">
                                                        <a ng-click="saveTranAssign(tran, 'vestfreq', i)">{{i}}</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.vestfreq"></span>
                                    </div>

                                </div>
                                <!-- Debt Tab -->
                                <div class="capGuide top10" ng-show="trantype(tran.type, 'Debt');">

                                    <div class="rightTitle interest-rate">
                                        <span>Interest Rate</span>
                                        <input ng-disabled="toggleView();"
                                             onkeydown="testForEnter();"
                                             ui-event="{blur : 'saveTran(tran)'}"
                                             ng-model="tran.interestrate">

                                        <ul class="dropdown-list drop-selector">
                                            <li class="dropdown standard">
                                                <a class="dropdown-toggle">
                                                    {{tran.interestratefreq}}<span class="invisible-drop">'</span>
                                                </a>
                                                <ul class="dropdown-menu">
                                                    <li ng-repeat="i in freqtypes track by $index">
                                                        <a ng-click="saveTranAssign(tran, 'interestratefreq', i)">{{i}}</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.interestrate"></span>
                                    </div>

                                    <p style="display:inline-block" class="rightTitle"><span>Valuation Cap</span><input ng-disabled="toggleView();"
                                                                                                                        onkeydown="testForEnter();"
                                                                                                                        ui-event="{blur : 'saveTran(tran)'}"
                                                                                                                        ng-model="tran.valcap">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.valcap"></span>
                                    </p>

                                    <p class="rightTitle"><span>Percent Discount</span><input ng-disabled="toggleView();"
                                                                                              onkeydown="testForEnter();"
                                                                                              ui-event="{blur : 'saveTran(tran)'}"
                                                                                              ng-model="tran.discount">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.discount"></span>
                                    </p>

                                    <p class="rightTitle"><span>Term (months)</span><input ng-disabled="toggleView();"
                                                                                           onkeydown="testForEnter();"
                                                                                           ui-event="{blur : 'saveTran(tran)'}"
                                                                                           ng-model="tran.term">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.term"></span>
                                    </p>
                                </div>

                                <!-- Safe Tab -->
                                <div class="capGuide top10" ng-show="trantype(tran.type, 'Safe');">

                                    <p style="display:inline-block" class="rightTitle"><span>Valuation Cap</span><input ng-disabled="toggleView();"
                                                                                                                        onkeydown="testForEnter();"
                                                                                                                        ui-event="{blur : 'saveTran(tran)'}"
                                                                                                                        ng-model="tran.valcap">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.valcapsafe"></span>
                                    </p>

                                    <p class="rightTitle"><span>Percent Discount</span><input ng-disabled="toggleView();"
                                                                                              onkeydown="testForEnter();"
                                                                                              ui-event="{blur : 'saveTran(tran)'}"
                                                                                              ng-model="tran.discount">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.discount"></span>
                                    </p>

                                </div>

                                <!-- Warrant Tab -->
                                <div class="capGuide top10" ng-show="trantype(tran.type, 'Warrant');">

                                    <p class="rightTitle"><span>Term (months)</span><input ng-disabled="toggleView();"
                                                                                           onkeydown="testForEnter();"
                                                                                           ui-event="{blur : 'saveTran(tran)'}"
                                                                                           ng-model="tran.term">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.termwarrant"></span>
                                    </p>

                                    <p class="rightTitle"><span>Strike Price</span><input ng-disabled="toggleView();"
                                                                                          onkeydown="testForEnter();"
                                                                                          ui-event="{blur : 'saveTran(tran)'}"
                                                                                          ng-model="tran.price">
                                        <span class="tooltip-icon" data-icon="&#xe044;" aria-hidden="true" data-placement="top" bs-tooltip="captabletips.pricewarrant"></span>
                                    </p>

                                </div>

                                <span class="blue-link delete-link" data-icon="&#xe00c;" ng-click="tranDeleteUp(tran);">Delete transaction</span>
                            </div>
                            <div class="capTab" ng-switch-when="documents">
                                <div ng-if="tran.evidence_data.length==0" class="linkedDocuments">
                                    Connect documents that support this transaction by clicking the link below.
                                </div>
                                <div ng-if="tran.evidence_data.length>0" class="linkedDocuments">
                                    <div ng-repeat="doc in tran.evidence_data" class="row-fluid">
                                        <ul class="pull-left">
                                            <li><span ng-click="viewEvidence(doc)">{{doc.docname}}</span></li>
                                            <li ng-if="doc.name||doc.investor"><span>{{doc.name || doc.investor}}'s version</span></li>
                                            <!--<li ng-if="!doc.name && !doc.investor"><span>Original upload</span></li>-->
                                        </ul>
                                        <span class="pull-right" data-icon="&#xe00f;" ng-click="removeEvidence(doc, tran)"></span>
                                    </div>
                                </div>
                                <span ng-hide="windowToggle" class="blue-link delete-link linkedDocuments" ng-click="editEvidence(tran);" data-icon="&#xe008;">Add Documents</span>
                                <div ng-show="windowToggle" class="standard-button linkedDocuments">
                                    <button class="btn" ng-click="editEvidence();">
                                        Finished!
                                    </button>
                                </div>
                            </div>
                            </accordion-group>
                        </accordion>
                          <span class="add-transaction-link"
                                ng-click="createTrantab()"
                                ng-if="currentTab!='documents'">
                              <span data-icon="&#xe053;" aria-hidden="true"></span>
                              <span>Add Transaction</span>
                          </span>
                      </span>

<!-- Issues Side Bar when UnEditable -->
                      <span ng-switch-when="5">

                        <!-- Global Tab -->
                            <div class="capGuide cap-overflow global">

                                <p class="belowTitle"><span ng-bind="activeIssue.issue"></span><span>Security Name</span></p>

                                <p class="belowTitle"><span ng-bind="activeIssue.date  | date:settings.shortdate"></span><span>Date</span></p>

                                <p ng-show="activeIssue.type" class="belowTitle"><span ng-bind="activeIssue.type"></span><span>Security Type</span></p>
                            </div>
                        <!-- Equity Tab -->
                        <div class="capGuide cap-overflow" ng-show="trantype(activeIssue.type, 'Equity');">
                            <p ng-show="activeIssue.premoney" class="belowTitle"><span ng-bind="formatDollarAmount(activeIssue.premoney)"></span><span tooltip-placement="right" tooltip="The valuation before taking in money in this round" class="forTooltip">Pre-Money Valuation</span></p>

                            <p ng-show="activeIssue.postmoney" class="belowTitle"><span ng-bind="formatDollarAmount(activeIssue.postmoney)"></span><span tooltip-placement="right" tooltip="The sum of the pre-money valuation and the total money paid into this round" class="forTooltip">Post-Money Valuation</span></p>

                            <p ng-show="activeIssue.ppshare" class="belowTitle"><span ng-bind="formatDollarAmount(activeIssue.ppshare)"></span><span tooltip-placement="right" tooltip="The price at which each share was purchased" class="forTooltip">Share Price</span></p>

                            <p ng-show="activeIssue.totalauth" class="belowTitle"><span ng-bind="formatAmount(activeIssue.totalauth)"></span><span tooltip-placement="right" tooltip="The sum total of shares authorized to be issued" class="forTooltip">Total Authorized</span></p>

                            <p ng-show="activeIssue.liquidpref" class="belowTitle"><span ng-bind="activeIssue.liquidpref"></span><span tooltip-placement="right" tooltip="The minimum return multiple each investor is gauranteed on a liquidity event" class="forTooltip">Liquidation Preference</span></p>

                            <p ng-show="activeIssue.partpref"  class="belowTitle"><span ng-bind="activeIssue.partpref"></span><span tooltip-placement="right" tooltip="Allows an investor to collect their liquidation prefence AND stock on a liquidity event" class="forTooltip">Participating Preferred</span></p>

                            <p ng-show="activeIssue.dragalong"  class="belowTitle"><span ng-bind="activeIssue.dragalong"></span><span tooltip-placement="right" tooltip="When a majority shareholder enters a sale, minority shareholders are also forced sell their shares" class="forTooltip">Drag Along</span></p>

                            <p ng-show="activeIssue.tagalong"  class="belowTitle"><span ng-bind="activeIssue.tagalong"></span><span tooltip-placement="right" tooltip="When a majority shareholder enters a sale, minority shareholders have the right to join the deal and sell their shares" class="forTooltip">Tag Along</span></p>

                            <p ng-show="activeIssue.paripassu[0].pariwith" ng-repeat="pari in activeIssue.paripassu track by $index"  class="belowTitle">
                                <span ng-bind="pari.pariwith"></span><span tooltip-placement="right" tooltip="Liquidation proceeds are distributed in proportion to each series' share of preference, instead of by seniority" class="forTooltip">Pari Passu With</span>
                            </p>
                        </div>
                          <!-- Options Tab -->
                          <div class="capGuide cap-overflow" ng-show="trantype(activeIssue.type, 'Option');">
                              <p ng-show="activeIssue.optundersec" class="belowTitle"><span ng-bind="activeIssue.optundersec"></span><span tooltip-placement="right" tooltip="The security each granted share will convert to upon exercise" class="forTooltip">Underlying Security</span></p>

                              <p ng-show="activeIssue.totalauth" class="belowTitle"><span ng-bind="formatAmount(activeIssue.totalauth)"></span><span tooltip-placement="right" tooltip="The sum total of shares authorized to be issued" class="forTooltip">Total Authorized</span></p>

                              <p ng-show="totalGranted(activeIssue.issue, trans)" class="belowTitle"><span ng-bind="formatAmount(totalGranted(activeIssue.issue, trans))"></span><span tooltip-placement="right" tooltip="The sum total of shares granted" class="forTooltip">Total Granted</span>
                              </p>

                              <p ng-show="activeIssue.price"  class="belowTitle"><span ng-bind="formatDollarAmount(activeIssue.price)"></span><span tooltip-placement="right" tooltip="The price each granted share can be purchased at when vested" class="forTooltip">Strike Price</span></p>

                              <p ng-show="activeIssue.terms" class="belowTitle"><span ng-bind="activeIssue.terms"></span><span tooltip-placement="right" tooltip="The total number of months until fully vested" class="forTooltip">Vesting Term (Months)</span></p>

                              <p ng-show="activeIssue.vestingbeginsdisplay" class="belowTitle"><span ng-bind="activeIssue.vestingbeginsdisplay"></span><span tooltip-placement="right" tooltip="Months until the vesting cliff % is vested" class="forTooltip">Vesting Cliff (Months)</span></p>

                              <p ng-show="activeIssue.vestcliff" class="belowTitle"><span ng-bind="activeIssue.vestcliff"></span><span tooltip-placement="right" tooltip="The percentage of granted shares that are considered vested on the cliff date" class="forTooltip">Vesting Cliff %</span></p>

                              <p ng-show="activeIssue.vestfreq" class="belowTitle"><span ng-bind="activeIssue.vestfreq"></span><span tooltip-placement="right" tooltip="The frequency that granted shares vest after the cliff date, distributed evenly by frequency until the vesting term ends" class="forTooltip">Post Cliff Frequency</span></p>
                          </div>

                          <!-- Debt tab -->
                          <div class="capGuide cap-overflow" ng-show="trantype(activeIssue.type, 'Debt');">

                              <p class="belowTitle" ng-show="activeIssue.premoney"><span ng-bind="formatDollarAmount(activeIssue.premoney)"></span><span tooltip-placement="right" tooltip="The valuation before taking in money in this round" class="forTooltip">Pre-Money Valuation</span></p>

                              <p class="belowTitle" ng-show="activeIssue.postmoney"><span ng-bind="formatDollarAmount(activeIssue.postmoney)"></span><span tooltip-placement="right" tooltip="The sum of the pre-money valuation and the total money paid into this round" class="forTooltip">Post-Money Valuation</span></p>

                              <p class="belowTitle" ng-show="activeIssue.interestrate"><span>{{activeIssue.interestrate}}% {{activeIssue.interestratefreq}}</span><span tooltip-placement="right" tooltip="The rate that interest accrues on this debt" class="forTooltip">Interest Rate</span></p>

                              <p class="belowTitle" ng-show="activeIssue.valcap"><span ng-bind="formatDollarAmount(activeIssue.valcap)"></span><span tooltip-placement="right" tooltip="The maximum pre-money valuation at which the debt notes convert to equity" class="forTooltip">Valuation Cap</span></p>

                              <p class="belowTitle" ng-show="activeIssue.discount"><span ng-bind="activeIssue.discount"></span><span tooltip-placement="right" tooltip="The percentage discount applied to the next round" class="forTooltip">Percent Discount</span></p>

                              <p class="belowTitle" ng-show="activeIssue.term"><span ng-bind="activeIssue.term"></span><span tooltip-placement="right" tooltip="The term of the note before expiration" class="forTooltip">Term (Months)</span></p>
                          </div>

                          <!-- Safe tab -->
                          <div class="capGuide cap-overflow" ng-show="trantype(activeIssue.type, 'Safe');">

                              <p class="belowTitle" ng-show="activeIssue.valcap"><span ng-bind="formatDollarAmount(activeIssue.valcap)"></span><span tooltip-placement="right" tooltip="The maximum pre-money valuation at which the safe converts to equity" class="forTooltip">Valuation Cap</span></p>

                              <p class="belowTitle" ng-show="activeIssue.discount"><span ng-bind="activeIssue.discount"></span><span tooltip-placement="right" tooltip="The percentage discount applied to the next round" class="forTooltip">Percent Discount</span></p>

                          </div>

                          <!-- Warrant tab -->
                          <div class="capGuide cap-overflow" ng-show="trantype(activeIssue.type, 'Warrant');">

                              <p ng-show="activeIssue.optundersec" class="belowTitle"><span ng-bind="activeIssue.optundersec"></span><span tooltip-placement="right" tooltip="The security each granted share will convert to upon exercise" class="forTooltip">Underlying Security</span></p>

                              <p class="belowTitle" ng-show="activeIssue.term"><span ng-bind="activeIssue.term"></span><span tooltip-placement="right" tooltip="The term of the warrant before expiration" class="forTooltip">Term (Months)</span></p>

                              <p ng-show="activeIssue.price"  class="belowTitle"><span ng-bind="formatDollarAmount(activeIssue.price)"></span><span tooltip-placement="right" class="forTooltip" tooltip="The price each granted share can be purchased at">Strike Price</span></p>

                          </div>
                      </span>

<!-- Transactions Side Bar when UnEditable -->
                      <span ng-switch-when="4">
                        <accordion ng-class="{'lessmargin': (activeTran.length == 1)}" class="transaction-accordion" close-others="true">
                        <accordion-group is-open="tran.active" is-disabled="singleTransaction(activeTran);"
                                         ng-repeat="tran in activeTran | orderBy:'date' track by $index" ng-switch on="currentTab">
                            <accordion-heading>
                                <span data-icon="&#xe031;" aria-hidden="true" ng-show="tran.active && activeTran.length > 1"></span>
                                <span data-icon="&#xe034;" aria-hidden="true" ng-show="!tran.active && activeTran.length > 1"></span>
                                <span>{{tran.date | date:settings.shortdate}} Transaction</span>
                            </accordion-heading>
                            
                            <div class="standard-button btn-group darkgray">
                                <button class="btn" ng-click="switchCapTab('details');" ng-class="{on:currentTab=='details'}">
                                    <span data-icon="&#xe01e;" aria-hidden="true">Details</span>
                                </button>
                                <button class="btn" ng-click="switchCapTab('documents');" ng-class="{on:currentTab=='documents'}">
                                    <span data-icon="&#xe60e;" aria-hidden="true">Evidence</span>
                                </button>
                            </div>

                            <div class="capTab" ng-switch-when="details">
                                <!-- Global Tab -->
                                <div class="capGuide cap-overflow global">
                                    <p ng-show="tran.investor" class="belowTitle"><span ng-bind="tran.investor"></span><span>Investor</span></p>

                                    <p ng-show="tran.units" class="belowTitle"><span ng-bind="formatAmount(tran.units)"></span><span>{{grantbyIssue(tran.issue)}}</span></p>

                                    <p ng-show="tran.forfeited" class="belowTitle"><span ng-bind="formatAmount(tran.forfeited)"></span><span>Forfeit</span></p>

                                    <p ng-show="tran.amount" class="belowTitle"><span ng-bind="formatDollarAmount(tran.amount)"></span><span>Total Paid</span></p>
                                </div>

                                <!-- Equity Tab -->
                                <div class="capGuide cap-overflow" ng-show="trantype(tran.type, 'Equity');">

                                    <p ng-show="tran.ppshare" class="belowTitle"><span ng-bind="formatDollarAmount(tran.ppshare)"></span><span tooltip-placement="right" tooltip="The price at which each share was purchased" class="forTooltip">Share Price</span></p>

                                    <p ng-show="tran.liquidpref" class="belowTitle"><span ng-bind="tran.liquidpref"></span><span tooltip-placement="right" tooltip="The minimum return multiple each investor is gauranteed on a liquidity event" class="forTooltip">Liquidation Preference</span></p>

                                    <p ng-show="tran.partpref" class="belowTitle"><span ng-bind="tran.partpref"></span><span tooltip-placement="right" tooltip="Allows an investor to collect their liquidation prefence AND stock on a liquidity event" class="forTooltip">Participating Preferred</span></p>

                                    <p ng-show="tran.dragalong"  class="belowTitle"><span ng-bind="tran.dragalong"></span><span tooltip-placement="right" tooltip="When a majority shareholder enters a sale, minority shareholders are also forced sell their shares" class="forTooltip">Drag Along</span></p>

                                    <p ng-show="tran.tagalong"  class="belowTitle"><span ng-bind="tran.tagalong"></span><span tooltip-placement="right" tooltip="When a majority shareholder enters a sale, minority shareholders have the right to join the deal and sell their shares" class="forTooltip">Tag Along</span></p>

                                </div>
                                <!-- Option Tab -->
                                <div class="capGuide cap-overflow" ng-show="trantype(tran.type, 'Option');">

                                    <p ng-show="tran.optundersec" class="belowTitle"><span ng-bind="tran.optundersec"></span><span tooltip-placement="right" tooltip="The security each granted share will convert to upon exercise" class="forTooltip">Underlying Security</span></p>

                                    <p ng-show="tran.price" class="belowTitle">
                                        <span ng-bind="formatDollarAmount(tran.price)"></span>
                                        <span tooltip-placement="right" tooltip="The price each granted share can be purchased at when vested" class="forTooltip">Strike Price</span></p>

                                    <p ng-show="tran.terms" class="belowTitle"><span ng-bind="tran.terms"></span>
                                        <span tooltip-placement="right" tooltip="The total number of months until fully vested" class="forTooltip">Vesting Term (months)</span></p>

                                    <p ng-show="tran.vestingbeginsdisplay" class="belowTitle"><span ng-bind="tran.vestingbeginsdisplay"></span><span tooltip-placement="right" tooltip="Months until the vesting cliff % is vested" class="forTooltip">Vesting Cliff (months)</span></p>

                                    <p ng-show="tran.vestcliff" class="belowTitle"><span ng-bind="tran.vestcliff"></span><span tooltip-placement="right" tooltip="The percentage of granted shares that are considered vested on the cliff date" class="forTooltip">Vesting Cliff %</span></p>


                                    <p ng-show="tran.vestfreq" class="belowTitle">
                                        <span ng-bind="tran.vestfreq"></span>
                                        <span tooltip-placement="right" tooltip="The frequency that granted shares vest after the cliff date, distributed evenly by frequency until the vesting term ends" class="forTooltip">Post Cliff Frequency</span></p>

                                </div>
                                <!-- Debt Tab -->
                                <div class="capGuide cap-overflow" ng-show="trantype(tran.type, 'Debt');">

                                    <p ng-show="tran.interestrate" class="belowTitle"><span>{{tran.interestrate}}% {{tran.interestratefreq}}</span><span tooltip-placement="right" tooltip="The rate that interest accrues on this debt" class="forTooltip">Interest Rate</span></p>

                                    <p ng-show="tran.valcap" class="belowTitle"><span ng-bind="formatDollarAmount(tran.valcap)"></span><span tooltip-placement="right" tooltip="The maximum pre-money valuation at which the debt notes convert to equity" class="forTooltip">Valuation Cap</span></p>

                                    <p ng-show="tran.discount" class="belowTitle"><span ng-bind="tran.discount"></span><span tooltip-placement="top" tooltip="The percentage discount applied to the next round">Percent Discount</span></p>

                                    <p ng-show="tran.term" class="belowTitle"><span ng-bind="tran.term"></span><span tooltip-placement="top" tooltip="The term of the note before expiration">Term (months)</span></p>
                                </div>

                                <!-- Safe Tab -->
                                <div class="capGuide cap-overflow" ng-show="trantype(tran.type, 'Safe');">

                                    <p ng-show="tran.valcap" class="belowTitle"><span ng-bind="formatDollarAmount(tran.valcap)"></span><span tooltip-placement="right" tooltip="The maximum pre-money valuation at which the safe converts to equity" class="forTooltip">Valuation Cap</span></p>

                                    <p ng-show="tran.discount" class="belowTitle"><span ng-bind="tran.discount"></span><span tooltip-placement="right" class="forTooltip" tooltip="The percentage discount applied to the next round">Percent Discount</span></p>

                                </div>

                                <!-- Warrant Tab -->
                                <div class="capGuide cap-overflow" ng-show="trantype(tran.type, 'Warrant');">

                                    <p ng-show="tran.term" class="belowTitle"><span ng-bind="tran.term"></span><span tooltip-placement="right" class="forTooltip" tooltip="The term of the warrant before expiration">Term (months)</span></p>

                                    <p ng-show="tran.price" class="belowTitle"><span ng-bind="formatDollarAmount(tran.price)"></span><span tooltip-placement="right" class="forTooltip" tooltip="The price each granted share can be purchased at">Strike Price</span></p>

                                </div>

                                <div class="capGuide conversion-activity" ng-show="tran.convert.length > 0">

                                    <h2>Activity</h2>
                                    <ul>
                                        <li ng-repeat="convert in tran.convert track by $index">
                                            <span>{{convert.date | date:settings.shortdate}}</span>
                                            <span ng-show="convert.method == 'Valuation' || convert.method == 'Price Per Share'">Converted from {{convert.issuefrom}} at {{formatDollarAmount(convert.effectivepps)}} Price-per-share</span>
                                            <span ng-show="convert.method == 'Split'">Split {{convert.split.numerator}} to {{convert.split.denominator}} at {{formatDollarAmount(convert.effectivepps)}} Price-per-share</span>
                                            <span ng-show="convert.direction == 'To'">Transferred {{convert.units}} from {{convert.investor_from}}</span>
                                            <span ng-show="convert.direction == 'From'">Transferred {{convert.units}} to {{convert.investor_to}}</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="capTab" ng-switch-when="documents">
                                <div ng-if="tran.evidence_data.length==0" class="linkedDocuments viewOnly">
                                    Connect documents that support this transaction by clicking Edit above.
                                </div>
                                <div ng-if="tran.evidence_data.length>0" class="linkedDocuments viewOnly">
                                    <div ng-repeat="doc in tran.evidence_data" class="row-fluid">
                                        <ul class="pull-left">
                                            <li><span ng-click="viewEvidence(doc)">{{doc.docname}}</span></li>
                                            <li ng-if="doc.name||doc.investor"><span>{{doc.name || doc.investor}}'s version</span></li>
                                            <!--<li ng-if="!doc.name && !doc.investor"><span>Original upload</span></li>-->
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            </accordion-group>
                        </accordion>
                      </span>

                      <span class="capGuide in-brief" ng-switch-when="3">
                        <div class="headsection row-fluid tabbed company-info">
                                <h1><img ng-src="{{ navState.company && '/photo/user?id='+activeInvestorEmail || '' }}">{{activeInvestorName}}</h1>
                        </div>
                        <div ng-show="userDict[activeInvestorEmail]" class="summary-bar">
                            <div ng-show="userDict[activeInvestorEmail].lastlogin" class="belowTitle">
                                <img src="/img/activity/login.png">
                                <div>
                                    <span>{{userDict[activeInvestorEmail].lastlogin | date:settings.shortdate}}</span><span>Last Login</span>
                                </div>
                            </div>
                            <div ng-show="userDict[activeInvestorEmail].received" class="belowTitle">
                                <img src="/img/activity/received.png">
                                <div>
                                    <span>{{userDict[activeInvestorEmail].received | date:settings.shortdate}}</span><span>Delivered</span>
                                </div>
                            </div>
                            <div ng-show="userDict[activeInvestorEmail].viewed" class="belowTitle">
                                <img src="/img/activity/view.png">
                                <div>
                                    <span>{{userDict[activeInvestorEmail].viewed | date:settings.shortdate}}</span><span>Last Viewed</span>
                                </div>
                            </div>
                            <div class="belowTitle">
                                <img src="/img/activity/permissions.png">
                                <div>
                                    <span>{{userDict[activeInvestorEmail].level}}</span><span>Permissions</span>
                                </div>
                            </div>
                        </div>

                        <div class="profile-link" ng-show="userDict[activeInvestorEmail]" ng-click="gotoProfile(activeInvestorEmail, activeInvestorRealName);">
                            <span data-icon="&#xe001;" aria-hidden="true"></span>
                            <span>View Full Profile</span>
                        </div>

                        <div ng-show="!companyIsZombie() && !userDict[activeInvestorEmail]" class="share-link">
                            <div ng-click="companyIsZombie() || modalUp();" class="profile-link">
                                <span data-icon="&#xe604;" aria-hidden="true"></span>
                                <span>Share with Investor</span>
                            </div>
                        </div>

                      </span>
                      <span class="capGuide" ng-switch-default>
                        <span ng-hide="toggleView();">
                            <div class="captour railpadding">
                                <h1 class="right-bar-header">Understand your Ownership</h1>
                                <p> This capitalization table, often referred to as a cap table, will show you exactly what percentage
                                    of your company each shareholder owns.</p>
                                <p>Enter your company's securities, shareholders and their holdings, and we'll take care of the rest.</p>
                                <br>
                                <ul>
                                    <li>What's a security?</li>
                                    <li>A financial instrument representing ownership, debt, or rights to ownership (e.g. Common, Series A, 2012 Option Pool)</li>
                                    <li>Why should I enter terms?</li>
                                    <li>These terms influence capitalization calculations, the more terms you enter the more accurate your information</li>
                                </ul>
                            </div>
                        </span>
                        <span class="in-brief" ng-show="toggleView();">
                            <div class="headsection row-fluid tabbed company-info">
                                <h1><img ng-src="{{ navState.company && '/photo/user?id=company:'+navState.company || '' }}">{{navState.name}}</h1>
                            </div>

                            <div class="summary-bar">
                                <div ng-show="totalPaid(rows)" class="belowTitle">
                                    <img src="/img/activity/invested.png">
                                    <div>
                                        <span ng-bind="totalPaid(rows)"></span><span>Total Invested</span>
                                    </div>
                                </div>
                                <div ng-show="totalShares(rows)" class="belowTitle">
                                    <img src="/img/activity/sharews.png">
                                    <div>
                                        <span ng-bind="totalShares(rows)"></span><span>Fully Diluted Units</span>
                                    </div>
                                </div>
                                <div ng-show="numShareholders()" class="belowTitle">
                                    <img src="/img/activity/people.png">
                                    <div>
                                        <span ng-bind="numShareholders()"></span><span>Shareholders</span>
                                    </div>
                                </div>
                            </div>
                        </span>
                      </span>
                </div>
                <div ng-show="chosenTab(tab, 'Activity')">
                    <div activity-feed height='viewportactivity' user='navState.userid' type="iss" view="activityView"></div>
                </div>
            </tab>
        </tabset>
    </internal-right-rail>
</div>
<div class="rightTabWindow" ng-if="windowToggle" ng-class="{showRightTab:windowToggle}" ng-style="viewportheight">
    <table class="status-table investor evidence">
        <tbody>
            <tr>
                <th class="left"></th>
                <th class="left">
                    Document Name
                </th>
                <th class="left">Tags</th>
            </tr>
        </tbody>
        <tbody ng-repeat="doc in eligible_evidence | filter:evidenceFilter | orderBy:evidenceOrder" ng-if="!doc.investor && !doc.doc_id">
            <tr class="empty-row"/>
            <tr>
                <td ng-click="toggleShown(doc)" class="pointer">
                    <div>
                        <span class="toggle-icon" ng-hide="doc.shown" data-icon="&#xe017;" aria-hidden="true"></span>
                        <span class="toggle-icon" ng-show="doc.shown" data-icon="&#xe01c;" aria-hidden="true"></span>
                    </div>
                </td>
                <td ng-click="viewEvidence(doc)">
                    <ul>
                        <li title="{{doc.docname}}">{{doc.docname}}</li>
                    </ul>
                </td>
                <td>
                    <span class="tag"
                          ng-repeat="tag in doc.tags"
                          ng-click="state.evidenceQuery = tag">
                        {{tag + (($last && ' ') || ', ')}}
                    </span>
                </td>
            </tr>
            <tr class="version" ng-show="doc.shown">
                <td/>
                <td>
                    <div>
                        <button class="check-box-button" ng-class="{selected:isEvidence(doc)}" ng-click="toggleForEvidence(doc);">
                            <span data-icon="&#xe023;" aria-hidden="true"></span>
                        </button>
                    </div>
                    <ul ng-click="viewEvidence(doc)">
                        <li>Original</li>
                    </ul>
                </td>
                <td/>
            </tr>
            <tr ng-repeat="invdoc in eligible_evidence | filter:evidenceFilter | orderBy:evidenceNestedOrder"
                ng-if="invdoc.original==doc.original && invdoc.doc_id && invdoc.investor"
                class="version" ng-show="doc.shown">
                <td/>
                <td>
                    <div>
                        <button class="check-box-button" ng-class="{selected:isEvidence(invdoc)}" ng-click="toggleForEvidence(invdoc);">
                            <span data-icon="&#xe023;" aria-hidden="true"></span>
                        </button>
                    </div>
                    <ul ng-click="viewEvidence(invdoc)">
                        <li>{{invdoc.name || invdoc.investor}}</li>
                    </ul>
                </td>
                <td/>
            </tr>
        </tbody>
    </table>
</div>

<div ng-hide="toggleView() || !tourshow" class="tour-box" ng-class="{'slidingcss25':oldSafari(), 'showtour':tourstate != 0}">
    <div class="standard-button small-standard-button" ng-click="moveTour();">
        <h2>Need Help?</h2>
        <button id='a_own_tour_start_bar' class="btn">Tour</button>
    </div>
    <div class="tour-stage first" ng-class="{'slidingcss25':oldSafari(), 'stage-one':tourstate >= 1}">
        <span ng-class="{'current-icon':tourstate == 1}" ng-click="gotoTour(1);">
            <span ng-show="tourstate <= 1">1</span>
            <span ng-hide="tourstate <= 1" data-icon="&#xe052;" aria-hidden="true"></span>
        </span>
        <h2>Shareholders</h2>
        <p ng-show="tourstate == 1">Enter your shareholder names. The table will automatically expand as you go.</p>
        <div class="standard-button small-standard-button" ng-click="moveTour();">
            <button class="btn">Next</button>
        </div>
    </div>
    <div class="tour-stage second" ng-class="{'slidingcss25':oldSafari(), 'stage-two':tourstate >= 2}">
        <span ng-class="{'current-icon':tourstate == 2}" ng-click="gotoTour(2);">
            <span ng-show="tourstate <= 2">2</span>
            <span ng-hide="tourstate <= 2" data-icon="&#xe052;" aria-hidden="true"></span>
        </span>
        <h2>Security</h2>
        <p ng-show="tourstate == 2">Name the security (e.g. Common, Seed, Series A)</p>
        <div class="standard-button small-standard-button" ng-click="moveTour();">
            <button class="btn">Next</button>
        </div>
    </div>
    <div class="tour-stage third" ng-class="{'slidingcss25':oldSafari(), 'stage-three':tourstate >= 3}">
        <span ng-class="{'current-icon':tourstate == 3}" ng-click="gotoTour(3);">
            <span ng-show="tourstate <= 3">3</span>
            <span ng-hide="tourstate <= 3" data-icon="&#xe052;" aria-hidden="true"></span>
        </span>
        <h2>Security Terms</h2>
        <p ng-show="tourstate == 3">Select the security type and we'll display terms so you can define the security</p>
        <div class="standard-button small-standard-button" ng-click="moveTour();">
            <button class="btn">Next</button>
        </div>
    </div>
    <div class="tour-stage fourth" ng-class="{'slidingcss25':oldSafari(), 'stage-four':tourstate >= 4}">
        <span ng-class="{'current-icon':tourstate == 4}" ng-click="gotoTour(4);">
            <span ng-show="tourstate <= 4">4</span>
            <span ng-hide="tourstate <= 4" data-icon="&#xe052;" aria-hidden="true"></span>
        </span>
        <h2>Individual Shares</h2>
        <p ng-show="tourstate == 4">Enter individual amounts. The terms inherit from the
            security, but you can always override them.</p>
        <div ng-show="tourstate == 4" class="standard-button small-standard-button" ng-click="closeTour(); tourNotification();">
            <button class="btn">Done!</button>
        </div>
    </div>
    <div class="tour-stage fifth" ng-show="tourstate != 0" ng-class="{'slidingcss25':oldSafari()}">
        <div class="tour-finish-button" ng-click="closeTour();">
            <button class="btn"><span data-icon="&#xe00f;" aria-hidden="true"></span></button>
        </div>
    </div>
</div>
</div>
</div>

<doc-mini-viewer docid="viewme"></doc-mini-viewer>
