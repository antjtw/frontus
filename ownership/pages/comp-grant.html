<div class="container">

  <div class="row-fluid">
    <div class="span8 docLibrary leftBlock">
      <div class="headsection row-fluid">
        <h1>{{selected.name}}</h1>

        <div class="row-fluid">

          <ul class="bodyText maintabs">
            <a href="/ownership/company-captable"><li class="button">Ownership</li></a>
            <li class="selectedtab">Grants</li>
            <a href="/ownership/company-status"><li class="button">Status</li></a>
           </ul>
        </div>
      </div>

      <div class="row-fluid">
        <div class="subnav-controls">
        </div>
      </div>

      <div class="row-fluid">
       <table class="tableView bodyText">
            <tr class="column-label">
           	<th><span class="longrow">Shareholder</span></th>
              <th>Granted</th>
              <th>Vested</th>
              <th>Forfeited</th>
              <th>Exercised</th>
            </tr>
          <tr class="pointer status-row" ng-click="getActiveTransaction(row.name)" ng-repeat="row in rows" ng-class="{rowSelected:row.state}">
            <td>
              <input class="pointer" disabled style="width:180px;" ng-model="row.name">
            </td>
            <td>{{row.granted}}</td>
            <td>{{row.vested}}</td>
            <td>{{row.forfeited}}</td>
            <td>{{row.exercised}}</td>
          </tr>
          <tr class='tablefooter'>
            <td></td>
            <td><input disabled value="{{totalTranAction('granted', trans)}}"></td>
            <td><input disabled value="{{totalVestedAction(rows);}}"></td>
            <td><input disabled value="{{totalGrantAction('forfeited', grants)}}"></td>
            <td><input disabled value="{{totalGrantAction('exercised', grants);}}"></td>
          </tr>
        </table>
      </div>
    </div>


    <div class="span4 capright">
      <div ng-switch on="sideBar">
        <span ng-switch-when="1">
          <div class="headsection tabbed row-fluid">
              <h2>{{activeInvestor}}</h2>
              <p>Terms from the ownership table</p>
          </div>
          <tabset class="trantabs">
            <tab ng-repeat="tran in activeTran" heading="{{tran.date | date:'shortDate'}}" active="tran.active">
                <div class="row-fluid trancore">
                    <div class="date-selection">
                        <p>Date {{tran.date  | date:'shortDate'}}
                        </p>
                    </div>
                    <div class="DivHelper"></div>
                </div>
              <accordion close-others="true">
                  <accordion-group class="overflow-tab" heading="Grant Information">
                      <div class="rightTitle"><span>Underlying Security</span>
                          <li class="dropdown standard small">
                              <a class="dropdown-toggle">
                                  {{tran.optundersec | maxLength}}<span class="invisible-drop">'</span>
                              </a>
                              <ul class="dropdown-menu">
                                  <li ng-repeat="i in allowKeys">
                                      <a ng-click="saveTranAssign(tran, 'optundersec', i)">{{i}}</a>
                                  </li>
                              </ul>
                          </li>
                      </div>

                      <p class="rightTitle"><span>Strike Price</span><input ui-event="{blur : 'saveTran(tran)'}"
                                                                                                                                                                           ng-model="tran.price"></p>

                      <p class="rightTitle"><span>Vesting Term (months)</span><input ui-event="{blur : 'saveTran(tran)'}"
                                                                                                                                                                     ng-model="tran.terms"></p>

                      <p class="rightTitle"><span>Vesting Cliff Date</span><input id="{{tran.$$hashKey}}"
                                                                                                                                                                         ui-event="{keydown:'saveTranDate(tran, \'vestingbegins\', $event)', blur:'saveTranDate(tran, \'vestingbegins\', \'blur\')'}"
                                                                                                                                                                         ng-change="saveTranDate(tran, \'vestingbegins\')"
                                                                                                                                                                         type="text"
                                                                                                                                                                         ng-model="tran.vestingbegins"
                                                                                                                                                                         data-date-format="mm/dd/yyyy"
                                                                                                                                                                         bs-datepicker></p>

                      <p class="rightTitle"><span>Vesting Cliff %</span><input ui-event="{blur : 'saveTran(tran)'}"
                                                                                                                                                                                               ng-model="tran.vestcliff"></p>


                      <div class="rightTitle"><span>Post Cliff Frequency</span>
                          <li class="dropdown standard small">
                              <a class="dropdown-toggle">
                                  {{tran.vestfreq}}<span class="invisible-drop">'</span>
                              </a>
                              <ul class="dropdown-menu">
                                  <li ng-repeat="i in freqtypes">
                                      <a ng-click="saveTranAssign(tran, 'vestfreq', i)">{{i}}</a>
                                  </li>
                              </ul>
                          </li>
                      </div>
                  </accordion-group>
                  <accordion-group heading="Grant Activity">
                  <ul>
                    <li class="grant-list" ng-repeat="act in tran.activeAct">
                        <div class="rightTitle"><span>Action</span>
                            <ul style="display: inline-block">
                                <li class="dropdown standard small">
                                    <a class="dropdown-toggle">
                                        {{act.action}}<span class="invisible-drop">'</span>
                                    </a>
                                    <ul ng-hide="toggleView();" class="dropdown-menu">
                                        <li ng-repeat="i in possibleActions">
                                            <a ng-click="saveGrantDrop(act, i)">{{i}}</a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                      <p class="rightTitle"><span>Date</span><input ng-change="saveGrant(act)" ng-model="act.date" data-date-format="mm/dd/yyyy" bs-datepicker></p>
                      <p class="rightTitle"><span>Shares</span><input ui-event="{blur : 'saveGrant(act)'}" ng-model="act.unit">
                    </li>
                  </ul>
                  </accordion-group>
              </accordion>
            </tab>
          </tabset>
        </span>

        <span ng-switch-when="2">
          <p>Investor Email <input disabled ng-model="activeInvestorName"></p>
        </span>
        <span class="capGuide" ng-switch-default>
            <h2>Manage your Grants</h2>

            <p>Grant information is derived from the ownership table, but allows for more control such as
                exercising or forfeiting shares. Any transaction in the ownership table that's not been fully
                paid for, and has an underlying stock class, will be considered a grant and display in this view.
            </p>

            <p>Actions taken here on any transaction will also be reflected in your ownership table,
                as both are simply views on your shareholder transactions.
            </p>
          </span>
      </div>
    </div>
  </div>
</div>
