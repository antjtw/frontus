<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<base href="../"/>
	<title>Investor Profile</title>
	
	<link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/bootstrap-responsive.css">
    <link rel="stylesheet" href="css/font-awesome.css">
    <link rel="stylesheet" href="css/style.css">
<!--     <link rel="stylesheet" href="css/style.css"> -->
	<link rel="stylesheet" href="css/more.css">
  
</head>
<body>
  <div id="navbar-example" class="navbar navbar-static">
    <div class="navbar-inner">
      <div class="container" style="width: auto;">
        <a class="brand" href="#"><img class="profileLogo" src="img/logo2.png"/></a>

        <ul class="nav" role="navigation">
          <li class="dropdown">
            <a id="drop1" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
            <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
              <li><a tabindex="-1" href="http://google.com">Action</a></li>
              <li><a tabindex="-1" href="#anotherAction">Another action</a></li>
              <li><a tabindex="-1" href="#">Something else here</a></li>
              <li class="divider"></li>
              <li><a tabindex="-1" href="#">Separated link</a></li>
            </ul>
          </li>
          <li class="dropdown">
            <a href="#" id="drop2" role="button" class="dropdown-toggle" data-toggle="dropdown">Dropdown 2 <b class="caret"></b></a>
               <ul class="dropdown-menu" role="menu" aria-labelledby="drop2">
                                    <li><a tabindex="-1" href="#">Action</a></li>
                                    <li><a tabindex="-1" href="#">Another action</a></li>
                                    <li><a tabindex="-1" href="#">Something else here</a></li>
                                    <li class="divider"></li>
                                    <li><a tabindex="-1" href="#">Separated link</a></li>
                                </ul>
                            </li>
                        </ul>
                        <button id="logoutButton" class="btn">Log out</button>
                    </div>
                </div>
            </div> <!-- /navbar-example -->
	
	<div class="container">
    	<div id="profilePage">
	
            <h1>Profile Settings</h1>
            <div id="successPassword" style="display:none; width:300px;" class="alert alert-success">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                Password changed successfully
            </div>
            <button id="editButton" class="btn">Turn On Editing</button>
           
            <fieldset>      
                            <legend>Personal Information</legend>
                            	<div id="photoDiv" class="row-fluid profileLine"> 
                                </div>
                                <div class="row-fluid profileLine hiddenField">   
                                    <div class="span1">
                                      <label>Name:</label>              
                                    </div><!--/span-->
                                    <div class="span6">
                                    <input type="text" disabled class="switchable profileUneditable" name="first_name" data-dojo-type="dijit/form/TextBox" data-dojo-props="trim:true, propercase:true"/>   
                                      <input type="text" disabled class="switchable profileUneditable" name="last_name" data-dojo-type="dijit/form/TextBox" data-dojo-props="trim:true, propercase:true"/> 
                                    </div><!--/span-->
                                </div>
                                <div class="row-fluid profileLines hiddenField">   
                                    <div class="span1">
                                      <label>Email:</label>              
                                    </div><!--/span-->
                                    <div class="span6">
                                      <input type="text" disabled class="profileUneditable" name="email" data-dojo-type="dijit/form/TextBox">
                                    
                                    </div><!--/span-->
                                </div>
                                <div class="row-fluid profileLines hiddenField">   
                                    <div class="span1">
                                      <label>Twitter:</label>              
                                    </div><!--/span-->
                                    <div class="span6">
                                      <span>http://twitter.com/</span><input disabled class="switchable profileUneditable" type="text" name="twitter" maxlength="20"/>
                                    
                                    </div><!--/span-->
                                </div>
                                <div class="row-fluid profileLines hiddenField">   
                                    <div class="span1">
                                      <label>LinkedIn:</label>              
                                    </div><!--/span-->
                                    <div class="span6">
                                      <span>http://linkedin.com/</span><input disabled class="switchable profileUneditable" type="text" name="linkedin" maxlength="20"/>
                                    
                                    </div><!--/span-->
                                </div>
                                <div class="row-fluid profileLines hiddenField">   
                                    <div class="span1">
                                      <label>Angel:</label>              
                                    </div><!--/span-->
                                    <div class="span6">
                                      <span>http://angel.com/</span><input disabled class="switchable profileUneditable" type="text" name="angel"/>
                                    
                                    </div><!--/span-->
                                </div>
                                <div class="row-fluid profileLines hiddenField">   
                                    <div class="span1">
                                      <label>Website:</label>              
                                    </div><!--/span-->
                                    <div class="span6">
                                       <input disabled class="switchable profileUneditable" type="url" name="website"/>
                                    </div><!--/span-->
                                </div>
                                <div id="companyCheck" class="row-fluid profileLines hiddenField">   
                                    <div class="span6">
                                       <input id="showCompany" class="profileUneditable" type="checkbox" name="investment_group"/><span>I'm part of an investment group</span>
                                    </div><!--/span-->
                                </div>
                                <div id="companyField" class="row-fluid profileLines hiddenField doubleHide">   
                                    <div class="span1">
                                      <label>Company:</label>              
                                    </div><!--/span-->
                                    <div class="span6">
                                       <input disabled class="switchable profileUneditable" type="text" name="company">
                                    </div><!--/span-->
                                </div>
            </fieldset>
            
            <fieldset> 
            <legend>Where should your investments send snail mail?</legend>
            	<div class="row-fluid profileLines hiddenField">   
                    <div class="span1">
                      <label>Address:</label>              
                    </div><!--/span-->
                    <div class="span6">
                    <input disabled class="switchable profileUneditable" type="text" name="street"/> 
                    </div><!--/span-->
                </div>
                <div class="row-fluid profileLines hiddenField">   
                    <div class="span1">
                      <label>City/State/Zip:</label>              
                    </div><!--/span-->
                    <div class="span8">
                    <input disabled class="switchable profileUneditable" type="text" name="city"/>
                    <input disabled class="switchable profileUneditable" type="text" name="state" maxlength="2"/>
                    <input disabled class="switchable profileUneditable" type="text" name="postalcode"/>
                    </div><!--/span-->
                </div>
                <div class="row-fluid profileLines hiddenField">   
                    <div class="span1">
                      <label>Country:</label>              
                    </div><!--/span-->
                    <div class="span6">
                    <input disabled class="switchable profileUneditable" type="text" name="country" maxlength="2"/> 
                    </div><!--/span-->
                </div>
                <div class="row-fluid profileLines hiddenField">   
                    <div class="span1">
                      <label>Phone Number:</label>              
                    </div><!--/span-->
                    <div class="span6">
                    <input disabled class="switchable profileUneditable" type="text" name="phone" maxlength="20"/> 
                    </div><!--/span-->
                </div>
            
            </fieldset>
            
            <fieldset> 
            <legend>Login Credentials</legend>
            <div class="row-fluid profileLines">   
                    <button id="resetButton" class="btn">Change Your Password</button>
                </div>
            
            </fieldset>
           
        </div>
      </div>
      
      <div id="changePassword" class="hiddenFieldx">
      <form name="resetPasswordform" id="login" class="center" action="" method="post" onsubmit="doReset(); return false;">
          <fieldset>
              
              <label class="loginLabel">Old Password:</label>
              <input required class="loginInput" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])\w{6,}" placeholder="password" id="password1" tabindex="4" name="oldpassword" type="password" onchange="this.setCustomValidity(this.validity.patternMismatch ? 'Password must contain at least 6 characters, including UPPER/lowercase and numbers' : '');
    if(this.checkValidity()) form.confirmpassword.pattern = this.value;">
    
              <label class="loginLabel">New Password:</label>
              <input required class="loginInput" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])\w{6,}" placeholder="password" id="password1" tabindex="4" name="password" type="password" onchange="this.setCustomValidity(this.validity.patternMismatch ? 'Password must contain at least 6 characters, including UPPER/lowercase and numbers' : '');
    if(this.checkValidity()) form.confirmpassword.pattern = this.value;">
    
              <label class="loginLabel">Confirm New Password:</label>
              <input required class="loginInput" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])\w{6,}" id="register_password" placeholder="confirm password" tabindex="5" name="confirmpassword" type="password" onchange="
    this.setCustomValidity(this.validity.patternMismatch ? 'Please enter the same Password as above' : '');
    ">
              <br>
              <button id="loginButton" type="submit" class="btn btn-success" tabindex="3">Reset</button>
              <br>
          </fieldset>
      </form>
      
      <p><button id="goBackButton" class="btn" tabindex="3">Go Back</button></p>
      </div>
      
    </div>
	
	<script>
	// from config.js
	 dojoConfig = {
	    async: 1,
	    cacheBust: false,
	    tlmSiblingOfDojo: false,
	    isDebug: true,
	    packages: [
	        { name: "app", location: "js" },
	        { name: "bootstrap", location: document.baseURI+"dojo-bootstrap" }
	    ]
	};
	</script>
	
	<!-- the hosted version: 
		<script src="//ajax.googleapis.com/ajax/libs/dojo/1.8.1/dojo/dojo.js" data-dojo-config="async: true"></script>
		-->

    <script src="dojo/dojo/dojo.js"></script>
    <script type='text/javascript' src="js/jquery-1.8.3.js"></script>
    
	<script>
	// from application.js
	require([
	    'dojo/query',
	    'dojo/dom-attr',
	    'dojo/dom-construct',
	    'dojo/dom-style',
	    'bootstrap/Scrollspy',
	    'bootstrap/Affix',
	    'dojo/NodeList-html',
	    'dojo/NodeList-manipulate',
	    'dojo/domReady!'
	], function(q, attr, constr, domStyle){
	    "use strict";

	    window.prettyPrint && window.prettyPrint();
	    q(".container-body [href='#'], .navbar [href='#']").on("click", function(e){ e.preventDefault(); return false; });

	    var pagelist = q("ul.nav.nav-pills.nav-stacked.bs-page-sidenav");
	    var menuLinkTop = q('.menu-link-top');
	    q(".container-body .marker").forEach(function(div, i){
	        var id = attr.get(div, "id"),
	            title = q(div).query('> h3').text();
	        if(title && id){
	            if(i === 0){
	                constr.place('<li class="active"><a href="#'+id+'">'+title+'</a></li>', menuLinkTop[0], "before");
	            } else {
	                constr.place('<li><a href="#'+id+'">'+title+'</a></li>', menuLinkTop[0], "before");
	            }
	        }
	    });
	    q('[data-spy="scroll"]').forEach(function(elm){
	        q(elm).scrollspy('refresh');
	    });
	/*
	    q(window).on('scroll', function(e){
	        if(e.target.body.scrollTop >= 540){
	            //menuLinkTop.addClass('affix').addClass('affix-bottom');
	            //menuLinkTop.affix();
	            domStyle.set(menuLinkTop[0], "display", "block");
	        } else {
	            //menuLinkTop.removeClass('affix').removeClass('affix-bottom');
	            domStyle.set(menuLinkTop[0], "display", "none");
	        }
	        console.log();
	    });
	*/

	});
	
	</script>
	

	<script type="text/javascript" charset="utf-8">
	    require([ 'dojo/query', 'dojo/dom-class', 'dojo/_base/array', /*'js/application.js', */ 'bootstrap/Dropdown', 'bootstrap/Button', 'bootstrap/Alert', 'dojo/domReady!' ], function(q, domClass, array){
	        var text = q('#dropfontstext'),
	            drop = q('#dropfonts'),
				drop1=q('#drop1'),
				drop2=q('#drop2');
	        drop.on('select', function(e){
	            var a = q(e.selectedItem).query('> a');
	            var cls = a[0].className;
	            array.forEach(['font-arial', 'font-tahoma', 'font-times', 'font-verdana'], function(fontCls){
	                text.removeClass(fontCls);
	            });
	            text.addClass(cls);
	        });
			drop1.on('select', function(e) {
				var a = q(e.selectedItem).query('> a');
				var ih = a[0].innerHTML;
				console.log(ih);
			});
	    });
	</script>
	
	<script src="brijj/brijj.js"></script>
	
	<script>
		function loadInvestorMenu(q, x) {
				var ul = q('ul',q('#drop1')[0].parentNode)[0];
				ul.innerHTML="";
				for(var i=1;i<x.length;i++) {
					ll = x[i][0];
					var li = document.createElement('li');
				//	<li><a tabindex="-1" href="http://google.com">Action</a></li>
	              	li.innerHTML='<a tabindex="-1" href="http://clem">'+ll+'</a></li>';
					ul.appendChild(li);
				};
		}
	</script>
	
	<script>
	require(['dojo/query'], function(q) { 
		SWBrijj.proc('profile', function(x) {
		  var y = x[0]; // the fieldnames
		  var z = x[1]; // the values
		  var h = {};
		  for(var i=0;i<y.length;i++) {
			  h[y[i]]=i;
			  var d = q('input[name='+y[i]+']')[0];
			  if (y[i] === "email") {
					  var src = "<img id='profilePic' src='photo/" + z[i] + "' style='width:250px; height:250px;'/>"				
					  jQuery("#photoDiv").append(src);
				  }
			  if (d) {
				   d.value=z[i];
				   jQuery(d).parent().parent().removeClass("hiddenField");
				   var contents = jQuery(d).val();
				  var charlength = contents.length;
				  newwidth =  charlength*9;
				  jQuery(d).css({width:newwidth});
			  }
		  }
	  });
		  SWBrijj.proc('investments', function(x) { loadInvestorMenu(q,x); } );
	});
	</script>
    
    <script>
	$(document).ready(function() {
		
		 jQuery("#showCompany").click(function(){
			 jQuery("#companyField").toggleClass("doubleHide");
			 
		 });
		
		 jQuery('.switchable').keydown(function(){
		 var contents = jQuery(this).val();
		 var charlength = contents.length;
		 newwidth =  charlength*7 + 20;
		 jQuery(this).css({width:newwidth});
		});
		
		
		
	});
	
	jQuery("#editButton").click(function() {
		jQuery(".switchable").each(function() {
			jQuery(this).toggleClass("profileUneditable");
			if (jQuery(this).is(':disabled')){
        		jQuery(this).removeAttr('disabled');
				jQuery(this).parent().parent().removeClass("hiddenField"); 
				jQuery("#editButton").text("Save Changes");
    		} else {
        		jQuery(this).attr('disabled', 'disabled');
				jQuery("#editButton").text("Turn On Editing");
				if (jQuery(this).val().length === 0) {
					jQuery(this).parent().parent().addClass("hiddenField"); 
				}
   			 }
		jQuery("#companyCheck").toggleClass("hiddenField");
		});
		if (jQuery("#editButton").text() === "Turn On Editing") {
		var firstName = document.querySelector("input[name=first_name]").value;
		var lastName = document.querySelector("input[name=last_name]").value;
		var street = document.querySelector("input[name=street]").value;
		var state = document.querySelector("input[name=state]").value;
		var postalcode = document.querySelector("input[name=postalcode]").value;
		var twitter = document.querySelector("input[name=twitter]").value;
		var linkedin = document.querySelector("input[name=linkedin]").value;
		var country = document.querySelector("input[name=country]").value;
		var phone = document.querySelector("input[name=phone]").value;
		SWBrijj.proc("user_update",firstName, lastName, street, state, postalcode, twitter, linkedin, country, phone, updated);
		
		}
	});
	
	function updated(x) {
  }
  
  	jQuery("#logoutButton").click(function() {
		SWBrijj.logout(doneLogout);
	});
	
	function doneLogout() {
		document.location.href = 'u/login.html';
	}
  
  	jQuery("#resetButton").click(function() {
		jQuery("#profilePage").addClass("hiddenFieldx");
		jQuery("#changePassword").removeClass("hiddenFieldx");
	});
	
	jQuery("#goBackButton").click(function() {
		jQuery("#profilePage").removeClass("hiddenFieldx");
		jQuery("#changePassword").addClass("hiddenFieldx");
	});
	
	function doReset() {
		var oldpassword = document.querySelector("input[name=oldpassword]").value;
		var newpassword = document.querySelector("input[name=confirmpassword]").value;
		SWBrijj.proc("change_password", oldpassword, newpassword, doneChange);
	}
	
	function doneChange () {
        jQuery("#successPassword").show();
		jQuery("#profilePage").removeClass("hiddenField");
		jQuery("#changePassword").addClass("hiddenField");
	}
	
	</script>
	
</body>
</html>
